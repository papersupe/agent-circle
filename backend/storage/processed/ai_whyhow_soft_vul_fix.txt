Teaching AI the ‚ÄòWhy‚Äô and ‚ÄòHow‚Äô of Software Vulnerability
Fixes
AMIAOGAO,SouthernMethodistUniversity,USA
ZENONGZHANG,TheUniversityofTexasatDallas,USA
SIMINWANG,SouthernMethodistUniversity,USA
LIGUOHUANG,SouthernMethodistUniversity,USA
SHIYIWEI,TheUniversityofTexasatDallas,USA
VINCENTNG,TheUniversityofTexasatDallas,USA
Understandingsoftwarevulnerabilitiesandtheirresolutionsiscrucialforsecuringmodernsoftwaresystems.
Thisstudypresentsanoveltraceabilitymodelthatlinksapairofsentencesdescribingatleastoneofthe
threetypesofsemantics(triggers,crashphenomenonandfixaction)foravulnerabilityinnaturallanguage
(NL)vulnerabilityartifacts,totheircorrespondingpairofcodestatements.Differentfromthetraditional
traceabilitymodels,ourtracinglinksbetweenapairofrelatedNLsentencesandapairofcodestatements
canrecoverthesemanticrelationshipbetweencodestatementssothatthespecificroleplayedbyeachcode
statementinavulnerabilitycanbeautomaticallyidentified.Ourend-to-endapproachisimplementedintwo
keysteps:VulnExtractandVulnTrace.VulnExtractautomaticallyextractssentencesdescribingtriggers,crash
phenomenonand/orfixactionforavulnerabilityusing37discoursepatternsderivedfromNLartifacts(CVE
summary,bugreportsandcommitmessages).VulnTraceemployspre-trainedcodesearchmodelstotracethese
sentencestothecorrespondingcodestatements.Ourempiricalstudy,basedon341CVEsandtheirassociated
codesnippets,demonstratestheeffectivenessofourapproach,withrecallexceeding90%inmostcasesfor
NLsentenceextraction.VulnTraceachievesaTop5accuracyofover68.2%formappingapairofrelatedNL
sentencestothecorrespondingpairofcodestatements.Theend-to-endcombinedVulnExtract+VulnTrace
achievesaTop5accuracyof59.6%and53.1%formappingtwopairsofNLsentencestocodestatements.These
resultshighlightthepotentialofourmethodinautomatingvulnerabilitycomprehensionandreducingmanual
effort.
CCSConcepts:‚Ä¢Computingmethodologies‚ÜíNaturallanguageprocessing;‚Ä¢Softwareanditsengi-
neering‚ÜíSoftwarecreationandmanagement;‚Ä¢Securityandprivacy‚ÜíSoftwareandapplication
security.
AdditionalKeyWordsandPhrases:softwaretraceability,vulnerabilityrepaircomprehension
ACMReferenceFormat:
AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg.2025.TeachingAIthe
‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes.Proc.ACMSoftw.Eng.2,FSE,ArticleFSE090(July2025),
24pages.https://doi.org/10.1145/3729360
Authors‚ÄôContactInformation:AmiaoGao,amiaog@smu.edu,SouthernMethodistUniversity,Dallas,Texas,USA;Zenong
Zhang,TheUniversityofTexasatDallas,Richardson,Texas,USA,zenong@utdallas.edu;SiminWang,siminw@mail.smu.edu,
SouthernMethodistUniversity,Dallas,Texas,USA;LiGuoHuang,lghuang@smu.edu,SouthernMethodistUniversity,
Dallas,Texas,USA;ShiyiWei,TheUniversityofTexasatDallas,Richardson,Texas,USA,swei@utdallas.edu;VincentNg,
TheUniversityofTexasatDallas,Richardson,Texas,USA,vince@hlt.utdallas.edu.
ThisworkislicensedunderaCreativeCommonsAttribution4.0InternationalLicense.
¬©2025Copyrightheldbytheowner/author(s).
ACM2994-970X/2025/7-ARTFSE090
https://doi.org/10.1145/3729360
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:2 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
Fig.1. Approachoverview.
1 Introduction
Cyberattacks,includingransomwareincidents,haveincreasinglytargetedcriticalinfrastructureand
companies,leadingtosignificantfinanciallossesandpubliccrises[55].Theexposureofmillions
of records due to security vulnerabilities highlights the urgent need for robust cybersecurity
measures [59]. Understanding the causes of vulnerabilities and the logic behind their fixes is
essentialforimprovingsoftwaresecurity,automatingvulnerabilityfixes,andgeneratingeffective
securitypatches[7].Applicationssuchasautomatedbug-fixgenerationandvulnerabilitypatching
relyheavilyontheabilitytocomprehendtherootcausesandreasoningbehindvulnerabilities,
which,whenunderstoodwell,canstreamlinethesoftwaremaintenanceprocess[27,29,36,58].
Thereasonsforvulnerabilityoccurrenceandtheirfixesareoftencomplicated,involvingdesign-
orimplementation-specificissuesthataffectboththesyntaxandsemanticsoftheprogram[58,65].
Thecomplexityoftheseissuesisheightenedbythefactthattherelevantinformationisscattered
acrossnaturallanguage(NL)artifacts,suchasbugreports,CommonVulnerabilitiesandExposures
(CVE)[2]summaries,andcommitmessages,aswellascodeartifacts,suchascommitsordiffsthat
fixthebugs[18,24,43].NLartifactsfrequentlyexplainthecauseandcrashphenomenonassociated
withvulnerabilities,whilethecodeprovidestheactualfix[5,43].Thechallengeisinbridgingthese
disparatesourcestoachieveaholisticunderstandingofhowvulnerabilitiesarecausedandfixed.
ExistingeffortsthataddressthisproblemtendtofocusoneitherNLartifacts[5,22,39,44,64,67]
orcodeartifacts[7‚Äì9,34,40,42,49],butrarelyonbothinconjunction.StudiesanalyzingNLartifacts
suchasbugreportsoftenhighlighttheimportanceofwell-writtenbugreportsforeffectivebug
fixes[5],whileothersfocusonautomaticallydiscoveringvulnerabilitiesfromtextualdescriptions
incommitmessagesandCVEsummaries[67].Theseapproachesfailtocapturetheunderlying
codelogicthatimplementsthefixes[27,29,43].Empiricalstudiesoncodepatternshaveidentified
commonbug-fixpatternsandautomaticprogramrepairtechniquesthatfocusoncodechanges
associated with vulnerabilities [7‚Äì9, 34, 40, 42, 49]. These approaches often overlook the rich
contextualinformationpresentinNLartifacts,whichcanprovidecriticalinsightsintothereasoning
behindthefixes[5,24,33,50].Bugreportsfrequentlycontaincrucialexplanationsofthesymptoms
ofavulnerability,theconditionsunderwhichitoccurs,andtheuser-reportedimpacts,allofwhich
canguidedevelopersinidentifyingandprioritizingfixes[5].Misclassifications,asdiscussedin
Herzigetal.‚Äôsstudy[24],demonstratehowthecorrectinterpretationofbugreportscandramatically
influencetheoutcomeofabugfix,wherecertainissuesthatareclassifiedasfeaturesinsteadofbugs
delayedessentialfixes.Similarly,studieshaveshownthatbugreportsummarieshelpdevelopers
quicklylocaterelevantissuesandunderstandtherationalebehindcodechanges[33].Inaddition,
Rastkaretal.[50]foundthatsummarizingbugreportseffectivelycontributestofasterandmore
efficientbugresolutionbyfilteringoutextraneousinformationandprovidingdeveloperswitha
conciseoverviewofthecriticalissue.
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:3
Tobridgethisgap,weproposeanoveltraceabilitymodel(asshowninFig.1)thattracesapairof
relatedNLvulnerabilityentitiesthatdescribeavulnerabilitytrigger(VT),itscrashphenomenon
(CP),andhowitisrepairedafterbeingfixed(AF)totheircorrespondingsourcelinesofcode.
Ourworkpresentsthefirstend-to-endtraceabilityapproachtoproducetherelationshipscritical
forunderstandingvulnerabilitiesandtheirfixesinbothNLandcodeartifacts.Weachievethis
intwosteps.First,wedevelopVulnExtract,whichleveragesacatalogof37discoursepatternsto
automaticallyextractpairedvulnerabilityentities‚ÄìVT,CP,andAF‚ÄìfromNLartifactssuchas
bugreports,commitmessages,andCVEsummaries.Thesediscoursepatterns,designedthrougha
qualitativeanalysisofvulnerabilityartifacts,actaslinguisticstructuresthatidentifykeyelements
describingthebug,itscrashphenomenon,anditsresolution.Inaddition,weintegratethesepatterns
asfeaturesinmachinelearningmodelstoenhancetheprecisionofextractingtheseentities.These
pairedentitiesprovideadetailedexplanationofthetriggerofthebug,thecrashphenomenon,and
thepost-fixactions.Second,wedevelopVulnTrace,whichleveragespre-trainedcodesearchmodels
totraceeachoftheseentitiesbacktotheircorrespondinglinesofcode.Thistechniqueenablesa
comprehensivemappingbetweentheNLartifactsandthespecificcodethatimplementsthefix.
ThetracinglinkbetweenapairofrelatedNLvulnerabilityentitiesandapairofrelatedlinesof
codeautomatesthemanualanalysisprocessfollowedbyahumandevelopertocomprehend"why"
and"how"avulnerabilitybugisfixed.
Weconductedextensiveempiricalexperimentstoevaluatetheeffectivenessofourapproach,
usingadatasetof341labeledCVErecords,whichincludecorrespondingbugreportsandcommit
messages,amountingto2,439sentences.ThedatasetwasannotatedwithourVT,CP,andAFlabels.
ToevaluatetheperformanceofVulnExtract,weappliedbothheuristicandmachinelearning-based
extractionmethods,incorporatingourdiscoursepatternsasfeatures.Theresultsdemonstratedthat
ourmodelachievesaveragerecalllevelsof100.00%,95.01%,and91.03%inaccuratelyidentifying
andextractingVT,CP,andAFentitiesfromNLartifactsrespectively.FortheVulnTracestep,we
evaluatedtheaccuracyofourcodesearchmodelsintracingtheseextractedNLentitiestotheir
correspondingcodelines.OurexperimentsdemonstratedthatVulnTraceachievesanaccuracy
of68.20%forVT/CP_Codemappingand68.33%forAF/CP_Codemapping,showcasingitseffec-
tivenessintracingextractedNLentitiestotheircorrespondingcodesegments.Thekeytakeaway
fromourexperimentsisthatcombiningNLanalysiswithcodesearchenhancestraceabilitybe-
tweenvulnerabilitydescriptionsandtheircorrespondingfixes,offeringamorecomprehensive
understandingofhowandwhyvulnerabilitiesarefixed.Ourapproachautomatesvulnerability
comprehensionandsignificantlyreducesthemanualeffortforhumananalyzerstocomprehend
vulnerabilities.Themaincontributionsofthepaperareasfollows.
‚Ä¢ Wehavedevelopedandgeneralizedacatalogof37discoursepatternsthatcanbeusedto
extractsentencesdescribingVT,CP,and/orAFfromnaturallanguagevulnerabilityartifacts.
‚Ä¢ We have conducted empirical experiments to identify the most effective approach (SVM
+ discourse patterns for VT, CP and AF) for automatically extracting the three types of
sentencesmentionedabove.
‚Ä¢ We propose a novel traceability model that can trace between a pair of related Natural
Language(NL)vulnerabilityentitiesandtheircorrespondingsourcelinesofcode.
‚Ä¢ Wehavecreatedadatasetof341labeledCVErecordswithcorrespondingbugreportsand
commitmessages,withatotalof2,439sentencesidentifiedasVT,CPand/orAF.
‚Ä¢ Areplicationpackageincludingalldataandcompleteresultsoftheempiricalexperimentsis
providedwiththisstudy.
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:4 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
Fig.2. MotivatingexampleofCVE-2017-12893[1].
2 MotivatingExample
Abby,avulnerabilityanalyst,needstounderstandbothwhyandhowavulnerabilitybugwasfixed.
Usingacodedifftool,shequicklyidentifieswherethevulnerabilitywasfixedbyexaminingthe
newlyaddedlinesofcode(e.g.,Line19markedwithaleading+signinFig.2b).
Tofullygraspthereasonbehindthebuganditsconsequences,Abbyseekstoexplorethecondi-
tionsthattriggeredthebugandwhereinthecodeitcausedsystemcrashes.Unfortunately,merely
reviewingthecodediffresultsoranalyzingthesourcecodeitself(e.g.,throughsyntacticorseman-
ticanalysis)cannoteasilyprovidetheseanswers.Togainamorecomprehensiveunderstanding,
sheturnstoNaturalLanguage(NL)artifactssuchasCVEsummaries,commitmessages,andbug
reports.Inatraditionalmanualprocess,Abbyattemptstolocateboththebug‚Äôstriggerandits
crashlocationswithinthesourcecode,whilealsoanalyzingthecommitmessagetounderstand
thefixindetail.Fig.2illustratesthisprocessusingareal-worldvulnerability,CVE-2017-12893[1],
showing the bug‚Äôs fix through a commit message. (Fig. 2a) alongside the corresponding code
snippet(highlightedinFig.2b).Thisprocessislabor-intensive,requiringAbbytoswitchbackand
forthbetweenthecommitmessageandthecodetomanuallymapeachsentencefromthecommit
messagetothecorrespondingcodelines.Suchamanualmappingcantakeasignificantamountof
time,andderivingusefulpatterns,liketheonesderivedinexistingworks[66],wouldrequireher
toanalyzehundredsofsimilarvulnerabilitycases‚Äîaneffortthatcouldtakemonths.
OurapproachaimstostreamlinethisprocessbyautomatingtheanalysisforAbby,helpingher
understandbothwhyandhowavulnerabilitybugwasfixed.Itachievesthisintwokeysteps:
First,theapproachautomaticallyextractsthreetypesofvulnerabilityentities(VT,AF,andCP)
fromnaturallanguageartifacts(asdescribedinSection1).Specifically,VTreferstoasentencethat
reportsthetrigger(origin)ofavulnerabilityissueinthesourcecodebeforetheimplementation
of a bug fix, while AF refers to a sentence that explains how a vulnerability bug is fixed after
the implementation of a bug fix. Lastly, CP refers to a sentence that describes a system crash
phenomenon(e.g.,BufferOverflow,NullPointerDereference,UseAfterFree,DivisionbyZero,
etc.)causedbyavulnerabilityinthesourcecode.Forinstance,inthecommitmessagefromFig.2a)
thesentence‚ÄúAddaboundscheckinname_len().‚Äù(inaredbox)indicatesthecorrectiveactiontaken
tofixthevulnerability,whichcorrespondstotheAFentitythatdescribeshowthevulnerability
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:5
wasresolved.Thesentence‚ÄúAfterweadvancethepointerbythelengthvalueinthebuffer,ensure
itpointstosomethingwithinthecaptureddata.‚Äù(inabluebox)referstothetriggerofthebug,
exemplifyingtheVTentity,whichdetailstheoriginofthevulnerabilityinthesourcecode.Finally,
thesentence‚ÄúThisfixesabufferover-read...‚Äù(inanorangebox)describesthecrashcausedbythe
bug,representingtheCPentity.Theseentities‚ÄîAF,VT,andCP‚Äîareinterconnectedandpertain
tothesamevulnerability.
Second,theapproachautomaticallytraceseachoftheseentitiesbacktotheircorresponding
codelinesinFig.2b)asfollows.
‚Ä¢ AF:"Addaboundscheckinname_len()."‚ÄîLine 19: ND_TCHECK2(*s, 1);
‚Ä¢ VT:"Afterweadvancethepointerbythelengthvalueinthebuffer,ensureitpointstosomething
withinthecaptureddata."‚ÄîLine 18: s += (*s) + 1;
‚Ä¢ CP:"Thisfixesabufferover-read..."‚ÄîLine 21: return(PTR_DIFF(s, s0) + 1);
Sincetheseentitiesareinterrelated,thetracinglinksmakeitcleartoAbbythatLine18,which
advancesthepointer(‚Äòs += (*s) + 1;‚Äô),triggeredthevulnerabilitybugthatledtoasystemcrash
atLine21(‚Äòreturn(PTR_DIFF(s, s0) + 1);‚Äô).Thiscalculationofpointerdifferencesprevents
out-of-boundsmemoryaccess.Additionally,thenewlyaddedLine19(‚ÄòND_TCHECK2(*s, 1);‚Äô),
whichperformsaboundscheck,fixesthebugbyensuringthepointerremainsvalidaftereach
advancement.
Inessence,ourapproachautomaticallygeneratestracinglinksbetweenpairsofrelatednatural
languagevulnerabilityentitiesandtheircorrespondingcodelinepairs,makingitsignificantly
easierforanalystslikeAbbytounderstandandtrackbugfixesefficiently.
3 ResearchQuestions
Toestablishafoundationforautomaticallygeneratingtraceabilitylinksbetweennaturallanguage
(NL) vulnerability artifacts and their corresponding code line pairs, our study investigates the
followingresearchquestions.Westructureourstudyintofourkeyphases:(1)identifyingand
analyzingdiscoursepatternsinvulnerabilityartifacts,(2)evaluatingtheirimpactonclassification,
(3)assessingtheireffectivenessincodetraceability,and(4)evaluatingend-to-endclassification
andtraceabilitysystemperformance.
Phase1:IdentifyingandAnalyzingDiscoursePatternsinNLVulnerabilityArtifacts.
‚Ä¢ RQ1.WhatandhowmanydiscoursepatternsforAF,VT,andCPcanbeidentifiedfromthe
NLartifacts?Whatarethemostfrequentpatternsforeach?HowdothemostfrequentVT,
AF,andCPpatternscorrelatewitheachother?
Motivation:NLartifacts,suchasCVE,commitmessages,andbugreports,exhibitrecurringlinguis-
ticpatternsthatstructurevulnerability-relatedinformation.Identifyingthesediscoursepatterns
providesessentialfeaturesthatcanenhanceautomatedanalysisandclassification.Additionally,
understandingcorrelationsbetweenVT,AF,andCPpatternsoffersinsightsintohowvulnerabilities
arediscussedandresolvedinpractice.
RelationshiptootherRQs:ThefindingsfromRQ1serveasanempiricalbasisforRQ2,where
weinvestigatewhetherthesepatternsimprovemachinelearning-basedclassification.RQ3assesses
atraceabilitymodelbuiltonthebasisofthesepatterns.
Phase2:EvaluatingtheImpactofDiscoursePatternsinVulnerabilityClassification.
‚Ä¢ RQ2.Howdopre-trainedmodels(withandwithoutdiscoursepatterns),SVMmodels(with
andwithoutdiscoursepatterns),andapurelyheuristic-basedapproachcompareinclassifying
sentencesdescribingVT,CP,andAFinVulnExtract?
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:6 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
Motivation:AfteridentifyingdiscoursepatternsinRQ1,weassesstheireffectivenessinimproving
theclassificationofvulnerability-relatedsentences.Thisquestionexploreswhetherincorporating
discoursepatternsenhancesmodelperformancecomparedtotraditionalmachinelearningand
heuristic-basedmethods.
RelationshiptootherRQs:Theeffectivenessofdiscoursepatternsinclassification(RQ2)directly
influencesRQ4,whereweexaminehowwelltheseclassificationscontributetoanend-to-end
traceabilitysystem.Additionally,theresultsinformRQ3bydeterminingthequalityofclassified
vulnerability-relatedsentencesthatserveasinputfortraceabilitymodels.
Phase3:ImprovingCodeTraceabilitywithVulnTrace.
‚Ä¢ RQ3.Howeffectivearecodesearchmodelsintracingvulnerabilityartifactstorelevantcode
usingVulnTrace?
Motivation:Beyondclassification,securityanalystsneedtotracevulnerabilitydescriptionsto
thecorrespondingcodechanges.RQ3evaluatestheperformanceofdifferentcodesearchmodels
inestablishingtheselinks,helpingtodeterminewhichapproachesbestutilizestructuredtextual
representationsforvulnerabilitytraceability.
RelationshiptootherRQs:RQ3buildsuponRQ2,asaccuratelyclassifiedvulnerability-related
sentencesarecriticalinputsfortraceabilitymodels.Furthermore,itsfindingscontributetoRQ4by
assessinghowwellVulnTraceperformswhenintegratedwithVulnExtract.
Phase4:AssessingtheEnd-to-EndEffectivenessofVulnExtract+VulnTrace.
‚Ä¢ RQ4.HoweffectiveisVuleExtract+VulnTraceincombination?
Motivation:Thefinalstepinourinvestigationistoevaluatethecompletesystem.Byintegrating
VulnExtract (classification)andVulnTrace(traceability),weassesswhetherourapproachimproves
efficiencyandaccuracyintrackingvulnerabilitiesfromNLartifactstosourcecode.
RelationshiptootherRQs:RQ4synthesizesinsightsfromallpreviousquestions.Thediscourse
patternsidentifiedinRQ1,theirimpactonclassificationinRQ2,andthetraceabilityperformance
inRQ3allcontributetoevaluatingthesystem‚Äôsoveralleffectiveness.Inaddition,thisRQaddresses
thepracticalimplicationsofourapproach,testingwhetherthecombinedsystemimprovesefficiency
andaccuracyinvulnerabilitycomprehension.
4 TheDiscourseofVulnerabilityDescriptions
Weaimtoidentifyacomprehensivesetofdiscoursepatterns,referredtointhisstudyasdiscourse
patterns,whicharecommonlyfoundinsentenceswithinvulnerability-relatedNLartifacts.A
discoursepatternisageneralizedlinguisticstructureorschemathatsignifiessemanticrelationships
betweenterms.Thesepatternsserveasformalizedrulesthatcanbeappliedtotheidentificationof
keyconceptsandconceptualrelationshipsinNLtext[38].Byemployingthesepatterns,weaimto
extractmeaningfulinsightsfromNLvulnerabilityartifacts,facilitatingadeeperunderstandingof
thecauseandresolutionofsoftwarevulnerabilities.
Tomeetthisobjective,weanswerthefollowingresearchquestionthroughaqualitativeand
quantitativeanalysis:
‚Ä¢ RQ1.WhatandhowmanydiscoursepatternsforAF,VT,andCPcanbeidentifiedfromthe
NLartifacts?Whatarethemostfrequentpatternsforeach?HowdothemostfrequentVT,
AF,andCPpatternscorrelatewitheachother?
Section4.1describesthemethodologyemployedintheopencodingprocedureandpresentsa
well-definedsetofdiscoursepatterns forVT,AF,andCP.Theseempiricalfindingsserveasthe
foundation for our automated relational traceability approach. The insights gained from RQ1
informtheevaluationofdiscoursepatternintegrationinVulnExtract (RQ2),theeffectivenessof
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:7
codesearchmodelsinVulnTrace(RQ3),andtheoverallperformanceofthecombinedVulnExtract
+VulnTraceapproach(RQ4).
4.1 OpenCodingAnalysis
Wefollowtheopencodingprocedure[10]toidentifythediscoursepatterns,whicharedescribed
next.
4.1.1 DataCollection. WeselectedthedatasetcollectedbyZhangetal.[66]forthefollowing
reasons.First,itisextensivelystudiedwithinthefuzzingliteratureandcompriseswell-documented
CVEs.Second,themajorityofCVErecordsinthisdatasetincludedirectlinkstothesourcecodediffs
ofthebugfixes,whichfacilitatedetailedanalysis.TheCommonVulnerabilitiesandExposures(CVE)
systemisastandardizedcatalogofpubliclyknowncybersecurityvulnerabilitiesandexposures.
Eachentry,oftenreferredtoasthe"CVEFullDescription,"providesacomprehensiveanalysisof
thevulnerability,includingitstechnicalnature,exploitationmechanisms,potentialimpacts,and
remediationstrategies.Thisdetailedinformationiscrucialforsecurityprofessionals,software
vendors,andorganizationstounderstandandaddressvulnerabilitieseffectively,ensuringbetter
protectionagainstcybersecuritythreats.Inaddition,mostoftheseCVErecordsarereproducible
andcomewithcallstacks,providinginvaluableinsightsintotheoriginsofthebugsandthespecifics
ofthefixes[66].
Theoriginaldatasetconsistsof693CVEsfromsixopen-sourceprograms:Binutils[47],FFm-
peg[57],libarchive[28],libxml2[48],systemd[56],andTcpdump[19].Werefinedthisdataset
toincludeonlyCVEswithcorrespondingbugreportsorcommitmessages,resultinginafinal
datasetof341CVEsfromtheaforementionedsixopen-sourceprograms:38fromBinutils,116from
FFmpeg,24fromlibarchive,48fromlibxml2,13fromsystemd,and102fromTcpdump.
Usinggitdiff[17],wegeneratedcodesnippetsforeachCVEbycomparingtheparentandfix
commitsprovidedin[66].WethensplittheCVEs,bugreports,andcommitmessagesintoindividual
sentences,producing2,439sentences.EachCVEwasanalyzedalongsideitscorrespondingcode
snippet,andthesentenceswereclassifiedasVulnerability-Trigger(VT),After-Fix(AF),orCrash-
Phenomenon(CP).Toensureclarityandconsistencyinannotation,weadoptedasentence-level
labelingapproach.Astatisticalanalysisofourdatasetrevealedthatmulti-sentencecaseswere
infrequent: only 3 cases (3.66%) for VT, 6 cases (0.77%) for AF, and 0 cases for CP. Given their
lowoccurrence,wefollowedasingle-sentenceannotationapproachtomaintainuniformityin
classificationwhileensuringalignmentwithourdownstreamclassificationmodels.Specifically,82
sentenceswerelabeledasVT,780asAF,and808asCP.
4.1.2 Coding Procedure. Two authors, both Computer Science Ph.D. students, performed the
labelinganddiscoursepatterndevelopmenttasksovera31-dayperiod.Eachauthordedicatedmore
than400hourstotheprocess,averagingapproximately13hoursperday.Theannotationprocess
consistedoftwomainphases:(1)sentencelabelingforAF,VT,andCPand(2)discoursepattern
developmentandcategorization.
PilotStudyforConsistency:Beforebeginningtheannotationofthe341CVEsinthedataset,a
pilot study was conducted to establish a shared understanding of the coding framework. This
involvedthefollowingsteps:1.Randomlyselectingasubsetof50additionalCVEsnotincludedin
thedataset.2.IndependentlyanalyzingtheCVEdescriptionstoidentifysentencescorresponding
toAF,VT,andCPandinferringdiscoursepatternsfromthesesentences.3.CalculatingCohen‚Äôs
KappavaluesforagreementonpositiveornegativelabelsforAF,VT,andCP.IftheKappavalue
didnotreachthe"almostperfectagreement"threshold(>0.8)asdefinedbyLandisandKoch[30],
disagreementswerediscussedandresolvedtoachieveconsensus.4.Repeatingtheabovestepswith
anewsetof50CVEsuntiltheKappavalueexceeded0.8.Aftertwoiterations,theCohen‚ÄôsKappa
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:8 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
valuesforidentifyingAF,VT,andCPwere0.83,0.84,and0.84,respectively,whichwasdeemed
sufficienttobeginannotatingthefulldataset.
The annotation process for the 341 CVEs involved: Labeling Sentences: Over 14 days, each
author independently labeled all sentences in the dataset as positive or negative for AF, VT,
and CP. Any disagreements were collaboratively reviewed and resolved to reach a consensus.
Pattern Development: Over the remaining 17 days, the authors developed discourse patterns
tocategorizethepositivesentences.Asharedspreadsheetwasmaintainedtodocumentnewly
identifiedpatterns.Whenoneauthoridentifiedanewpattern,itwasrecordedinthespreadsheet,
andtheotherauthorwasnotifiedforverification.IndependentAssignmentsandResolution:The
assignment of a discourse pattern to each positive sentence was done independently by both
authors. Any disagreements in pattern assignment were subsequently reviewed and resolved
throughcollaborativediscussion.
Toensuretherobustnessandgeneralizabilityofourdiscoursepatterns,weadoptedaleave-one-
outcross-validation(LOOCV)[4]patterndevelopmentapproachacrosssixopen-sourcedatasets:
Binutils,FFmpeg,libarchive,libxml2,systemd,andTcpdump.Thecoreideawastoiterativelyuse
onedatasetasatestingset,whiledevelopingandrefiningpatternsusingtheremainingfivedatasets
as the training set. This procedure allowed us to focus on patterns that generalize well across
differentdatasetsandavoidoverfittingtoanyspecificone.DataPartitioning:Theentiredataset
consistingof341CVEsfromsixprogramswasdividedintosixsubsets,eachcorrespondingtoone
oftheprograms:Binutils(38CVEs),FFmpeg(116CVEs),libarchive(24CVEs),libxml2(48CVEs),
systemd(13CVEs),andTcpdump(102CVEs).IterationProcess:Ineachiteration,oneofthesix
datasetswasexcludedasthetestingset,andtheremainingfivedatasetswerecombinedtoformthe
trainingset.Thisprocesswasrepeatedsixtimes,witheachdatasetservingasthetestingsetonce.
PatternLearningandRefinement:(1)TrainingPhase:Foreachiteration,discoursepatterns
wereidentifiedandrefinedbasedonthefivetrainingdatasets.Thesepatternsweredevelopedby
manuallyanalyzingsentencesthatdescribeVT,AF,and/orCP.(2)TestingPhase:Oncepatterns
wereestablishedusingthetrainingset,theywereappliedtotheexcludedtestingset.Importantly,
patternsorkeywordsthatonlyappearedinthetestingsetandwerenotobservedinanyofthe
trainingdatasetswereexcluded.Thisstepensuredthatpatternsusedforentityextractionwerenot
overlydependentonanyonedatasetandweretrulygeneralizable.ExclusionofTesting-Specific
Patterns: Any patterns or keywords found only in the testing set and not present in the five
trainingsetswereexcludedduringthepatternapplicationphase.Thisensuredthatthediscourse
patternswererobustandnotoverfittedtoanyspecificdataset.
To minimize subjectivity, both coders independently analyzed all 341 CVEs, marking each
sentenceasVT,AF,orCPifitindicatedthedescriptionofVT,AF,orCP.TheyalsomapeachVT,
AF,andCPtotheircorrespondingcodesnippetgeneratedbygitdiff.Sentencescouldpotentially
fallintomultiplecategoriessimultaneously.Discoursepatternsweretheninferredfromthemarked
sentences,andeachpatternwasassignedauniquecode,uniquelyidentifyingaDiscoursepattern.
Itispossibletoinfermorethanonepatternfromasentence.Anonlinespreadsheetfacilitated
thesharingofpatterncatalogbetweenthetwocoders,enablingtherescueoradditionofnew
patterns.Whenonecoderindependentlyidentifiedanewpattern,itwasincludedinthecatalog
and the other coder was notified. The newly identified patterns were verified by both coders.
Similarpatternswereconsolidatedintoamoregeneralpattern,andexistinglabelswereupdated
accordingly,withthemergingoverseenbybothofthecoders.Anydisagreementswereaddressed
throughcollaborativediscussionsuntilaconsensuswasreached.Additionally,twodomainexperts
inSEprovidedadviceon"HardtoDetermine"patterns.Thisiterativeprocessinvolvedcontinuous
refinementofthepatterncatalogandresolutionofambiguouscases.
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:9
Table1. TopfrequentdiscoursepatternsforAF,VT,andCP.
AF VT CP
Code AFBC BFDN CLBO
Description Sentence describes applying a bound Sentencedescribes code didnot doa Sentence indicates a buffer
checktoexistingcode. specificaction(e.g.apropervariableini- overflowinexistingcode.
tialization,aproperboundcheck,etc.)
whichwouldcauseabug.
Rule [verb] [method/variable] [bound] [method/variable][donot][verb][com- [buffer] [overflow] [adv]
[check][adv][method/variable] plement] [method]
Example CVE-2017-12897/ISO CLNS: Use In lldp_private_8023_print() the case The BGP parser in tcp-
ND_TTEST()fortheboundschecksin blockforsubtype4(MaximumFrame dump before 4.9.2 has a
isoclns_print(). Size TLV, IEEE 802.3bc-2009 Section buffer over-read in print-
79.3.4)didnotincludethelengthcheck. bgp.c:bgp_attr_print().
Intotal,outof42initialpatternsidentified,9patternsweremergedinto4moregeneralpatterns,
resultinginatotalof37uniquepatterns‚Äî6forVT,16forAF,and15forCP.
4.1.3 CodingCriteriaandAgreement. Alistofcodingcriteriawasprovidedfortwocodersand
someimportantcriteriaweresummarizedbelow.RegardingVT,sentencesthatdescribeanissueor
errorcausedbycodethatfailstoperformarequiredactionshouldbeincludedhere.Thiscould
involvecodethatisincomplete,lacksvalidation,orintroducespotentialbugsduetomissingchecks
or faulty logic. Regarding AF, sentences that describe actions taken to modify or update code
shouldbeincludedunderthiscategory.Thesesentencesoftenindicatechangestoexistingsoftware
functionality,suchasadding,removing,orupdatingafeature,method,orcheck.RegardingCP,
sentencesthatdescribecrashphenomenashouldbeincludedhere.Thesedescriptionsoftenfocus
onspecificsecurityissueslikebufferoverflows,null-pointerdereference,oruseafterfree,etc.in
thecode.Inter-coderagreementwasevaluatedusingCohen‚ÄôsKappavalue.Ouranalysisreveals
highlevelsofagreement,withCohen‚ÄôsKappavaluesexceeding0.8(0.83forVT,0.84forAF,and
0.84forCP),indicativeofalmostperfectagreementaccordingtoLandisandKoch.
4.1.4 CodingResultsandAnalysis. ToaddressRQ1,theopencodingapproachresultedinacatalog
of37discoursepatterns,consistingof6VTpatterns,16AFpatterns,and15CPpatterns,whichare
shownin[16].Table1showsthemostfrequentAF,VT,andCPpatterns.BycomparingtheAF,VT,
andCPpatterns,weexaminethecorrelationsbelowtoaddressthesecondandthethirdpartof
RQ1.
VTpatterns.ThethreemostfrequentVTpatternsaccountfor70.3%oftheCVEsthatcontain
VT.Inadditiontothemostfrequentpattern(BFDN)showninTable1,thetwootherpatternsare:
(1)BFWD,whichinvolvessentencesusingmodalverbslike"will"or"would"toindicatethat,under
certainconditions,avulnerabilitywilloccur,suchas"When‚Äòuvalue‚Äôisaspecificvalue,‚Äòblock_start
+value‚Äôwillcauseintegeroverflow.";and(2)BFCU,whichcorrespondstosentencesusingverbslike
"remove"or"clean"toindicatethattheremovalofcertainvariables/statements/assignmentscanpre-
venttheoccurrenceofavulnerability,suchas"RemoveuseofFF_PROFILE_MPEG4_SIMPLE_STUDIO
asanindicatorofstudioprofile."
CPpatterns.ThethreemostfrequentCPpatternsaccountfor72.9%oftheCVEsthatcontain
CP.Inadditiontothemostfrequentpattern(CLBO)showninTable1,thetwootherpatternsare:
(1)CLNP,whichinvolvessentencesdescribingthecrashphenomenon"nullpointerdereference"to
indicatetheresolutionofacrash,suchas"Fixes:nullpointerdereference.";and(2)CLOOA,which
correspondstosentencescontainingthephrase"OOB(out-of-bounds)access/read/write"todescribe
themitigationofanOOBvulnerability,suchas"Checkforsize_tandvectorresize()overflowtoavoid
OOBwritesduringvectorallocation."
AFpatterns.ThethreemostfrequentAFpatternsaccountfor34.6%oftheCVEsthatcontain
AF.Inadditiontothemostfrequentpattern(AFBC)showninTable1,thetwootherpatternsare:
(1)AFA,whichinvolvessentencesusingverbslike"avoid"or"reject"todescribetherejectionor
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:10 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
avoidanceofcertainvariableassignmentstofixavulnerability,suchas"Rejectvp8videofilesthat
havealphaandimageplanesofdifferentsizes.";and(2)AFR,whichcorrespondstosentencesusing
verbslike"adjust"or"set"toindicateamodificationofavariable‚Äôsassignmenttofixavulnerability,
suchas"SetthedefaultEXTINFdurationto1msifthedurationissmallerthan1ms."
Correlations.Withinvulnerabilityartifacts,weoftenobservepatternsthatfrequentlyco-occur.
ThemostfrequentCPpattern,CLBO,asshowninTable1,oftenappearsalongsideVTpatternsthat
describemissingkeyactions,suchasBFDN,andAFpatternsthatinvolveapplyingboundschecks,
suchasAFBC(bothshowninTable1).Inthesecases,theabsenceofpropervalidation,represented
by BFDN, leads to unsafe memory access, which results in buffer overflows or over-reads, as
capturedbyCLBO.
Furthermore,AFpatternslikeAFBC,whichinvolveaddingboundschecks(e.g.,"UseND_TTEST()
fortheboundschecksinisoclns_print()"),oftenco-occurasacorrectiveactionfollowingtheiden-
tificationofvulnerabilitieswherethesevalidationsweremissing.ThisinterplaybetweenBFDN,
CLBO,andAFBC highlightsarecurringsequenceinsoftwarevulnerabilities:thefailuretoimple-
mentappropriateboundschecks(BFDN)leadstomemory-relatederrors(CLBO),whicharethen
mitigatedthroughcorrectivemeasureslikeboundschecks(AFBC).
ThiscorrelationillustrateshowVT,CP,andAFpatternsinteract,withmissedvalidationsteps
causing crashes and subsequent fixes involving bounds checks. Understanding these patterns
underscorestheimportanceofidentifyingandaddressingVTissuesearlytopreventCP-related
consequences,whilealsoemphasizingtheroleofAFpatternsinmitigatingthevulnerabilities
causedbysuchoversights.
5 Approaches
Ourapproachenablesautomatedcomprehensionofwhyandhowavulnerabilityisfixedviatwo
keysteps:VulnExtract andVulnTraceasshowninFig.1.
5.1 VulnExtract:AutomaticallyExtractEssentialInformationfromNaturalLanguage
(NL)VulnerabilityArtifacts
ManuallyextractingessentialinformationdescribingVT/AF/CPfromNLvulnerabilityartifactsis
extremelyeffort-consuming.Tomeetthischallenge,weaimtoautomatetheextractionprocess.We
proposeandcomparefourapproachestoautomaticallyextractVT/AF/CPfromtheNLvulnerability
artifacts.WewillextracteachsentencethatcontainsVT,AForCP(definedinSection2).Wechoose
asentenceasthelevelforlinguisticanalysisbecauseitcontainsrichercontextualinformationto
describeeachofthethreetypesofentities.Notethatsometimesasentencemaycontainmorethan
onetypeofentity.
5.1.1 HeuristicPatternApproach. Thisapproachadoptsaheuristicpatternmethodologywherein
weimplementthe37manuallyidentifieddiscoursepatternstoautomaticallyapplythemtonew
CVEissues.Specifically,weassesswhetheranyofthepatternsareapplicableforeachsentence
inagivenCVEsummary,bugreport,andcommitmessage.Ifapatternappliestoasentence,it
indicatesthatthesentencecontainsadescriptionofVT,CPorAF.Consequently,thediscourse
patternapproachlabelseachsentenceascontainingVT,CP,orAFifandonlyifatleastonepattern
isapplicable.
Weemployheuristicstoalignsentenceswithourdiscoursepatternstoimplementthepatterns.
EachpatternfromourcatalogwasimplementedusingtheNaturalLanguageToolkit(NLTK)[6]in
Python3,utilizingtheJupyterNotebookplatformfordevelopmentandtesting.
5.1.2 TraditionalMachineLearning. FollowingthemethodologyoutlinedbyChaparroetal.[10],
we experiment with a machine learning approach using Support Vector Machines (SVM). We
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:11
implementourbinarySVMclassifierusingthescikit-learnmachinelearningpackage[45].Inthis
approach,eachsentenceistreatedasatraininginstance,withpositiveinstances(sentences)labeled
asVT,CPorAF,andsentenceswithnodescriptionofVT,CPorAFlabeledasnegativeinstances.
TwofeaturetypeswereusedtotrainthebinarySVMclassifier:
‚Ä¢ DiscoursepatternsThesearepatternfeaturesderivedfromtheheuristicapproachdetailed
inSection4.1.EachVT,CPandAFpatternisrepresentedasabooleanfeature,indicating
whetherthesentencecontainsadescriptionofVT,CPorAF,respectively.VT,CPandAF
featuresareemployedbytheVTclassifier,CPclassifierandAFclassifier,respectively.
‚Ä¢ N-gramsThesefeaturesrepresentcontiguoussequencesofntermswithinasentence.We
incorporatedunigrams,bigrams,andtrigrams,transformingeachsentenceintoavectorof
counts,indicatingitspresenceorabsencewithinthesentence.
WeoptimizethehyperparametersoftheSVMclassifierusinggridsearch,asimplementedinthe
scikit-learn[45]package‚ÄôsGridSearchCVfunction.Thehyperparametergridexploredincludesthe
followingsettings.WetunethepenaltyparameterCoftheSVMclassifiersviagridsearchonthe
parametertuningfold.Weexperimentwith20evenlyspacedparametervaluesovertheinterval
[0.001,100].TheoptimalCisselectedbymaximizingtheF1scoreofthetrainedSVMstoidentify
VT,CP,andAFentitiesinvulnerabilityartifacts.
5.1.3 Pre-trainedModels. Pre-trainedmodels,whicharetrainedonself-supervisedlearningtasks
usingalargeamountofunlabeleddata,possessalotoflinguisticandcommonsenseknowledge
andhavebeenshowntooutperformtraditionalmachinelearningapproaches,includingearlydeep
learningapproaches(e.g.,RNNssuchasLSTMs),onavarietyofNLPandSEtasks[15,23,32].
Hence,wechoosepre-trainedmodelsasoneofourcandidateapproachestoindicateifthesentence
containsadescriptionofVT,CPorAF.
Specifically,wechosefivestate-of-the-artpre-trainedmodelsfromHuggingFacelibrary[62],
namelyBERT[13],DistilBERT[14],ELECTRA[25],SpanBERT[26],RoBERTa[35],andfine-tuned
themonthetrainingportionofourdata.EachtrainingsentencecorrespondstoaCVE,labeledas
positiveifandonlyifthesentenceisidentifiedasVT,CP,orAF.Eachsentenceisrepresentedasa
sequenceofwordsinthecorrespondingVT,CPorAFdescription.Inotherwords,manualfeature
engineeringisnotneededforpre-trainedmodels.Nevertheless,recentworkonSEtaskshasshown
thataugmentingtheinputwordsequencewithhand-craftedfeaturescanoftenyieldimproved
performance[31,60].Hence,weadditionallyexperimentwithaversionofourpre-trainedmodels
whereeachofthemwillbeprovidedwithhand-craftedfeatures.
Thequestion,then,is:whathand-craftedfeaturesshouldbeused?GiventhattheSVMexperi-
mentsemployedtwotypesoffeatures,discoursepatterns,andn-grams,andthatn-gramscanbe
readilyextractedfromtheinputwordsequence,itisanaturalchoicetousethediscoursepatterns
asfeaturesforthepre-trainedmodels.Wederivefeaturesfromthediscoursepatternsforthepre-
trainedmodelsinthesamewayasintheSVMexperiments,meaningthatweemployonebinary
featureforeachpatternwhosevalueis1ifandonlyifthepatternisapplicabletothesentence
towhichthetraininginstancecorrespondsto.Theresultingbinary-valuedfeaturevectoristhen
concatenatedwiththevectorencodingtheinputsentence,andtheresultingvectoristhenused
forextractingVT,CPandAF.Weusedthe12-layerand768-hiddenversionforallmodelsand
tunedthedropoutrateforeachpre-trainedmodelusingtheparametertuningset,consideringthe
followingparametervalues:{0.1,0.2,0.3,0.4,0.5}.
5.2 VulnTrace:ANovelTraceabilityModelbetweenNLVulnerabilityArtifactsandCode
TraditionaltraceabilitymodelstracebetweenasingleNLentity(e.g.,requirement,bugreport)and
code.Therefore,theylacktheabilitytorecognizeeachlineofcode‚Äôsspecificrolewhenapairof
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:12 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
relatedlinesofcodeneedtobecomprehendedinvulnerabilityanalysis,suchasidentifyingwhich
linesofcodecontainthebugandwhichonesshowthecrashlocation[3].Thislimitstheirability
toexplaintheunderlying"Why"and"How"ofasoftwarevulnerabilityfix.
Toovercomethischallenge,weproposeanoveltraceabilitymodel,VulnTrace,whichnotonly
establishesatracinglinkbetweenanNLvulnerabilityentity(i.e.,VT,CPorAF)andthecorre-
spondingcodelinesbutalsounderstandsthespecificroleeachlineofcodeplays.Unliketraditional
traceability models that only trace between a single entity to code or between a pair of code
segments,ournewtraceabilitymodeltracespairsofrelatedvulnerabilityentitiestocorresponding
pairsofcodelines.Atthesametime,thesemanticrelationbetweenthepairofvulnerabilityentities
are maintained. We cast this traceability problem into a code search task described in Section
4.2.1.Specifically,asentencelabeledasVT,CPorAFbyVulnExtrat isusedasthesearchquery
forthecodesearchtask,andthecodesnippetsgeneratedbyGitDiffareusedasapoolofcode
candidateswheretosearchfrom.Finally,thecodesearchresultsreturnthecorrespondinglinesof
codethatimplementVT,CPorAF.Inthisway,atracinglinkbetweenapairofrelatedvulnerability
entities(VT/CP,CP/AForVT/AF)andapairofcodelinesthatimplementeachoftheseentitiesis
established.Thisallowsustoidentifythespecificrole(i.e.,vulnerabilitytrigger,crashphenomenon,
orfixaction)eachlineofcodetakesandunderstandtherationalesbehindasoftwarevulnerability.
CodeSearch.Pre-trainedmodelsshowtheirrobustabilitiesincodesearchtasks.Hence,we
choosepre-trained codesearchmodels inVulnTrace. Specifically,wechose sixstate-of-the-art
pre-trainedmodelsfromtheHuggingFacelibrary[62],namelyUniXCoder[20],CoCoSoDa[53],
GraphCodeBERT[21],CodeBERT[15],RoBERTa[35],RoBERTa-Code[37].
Tomaintainthefairnessoftheexperiment,wefollowtheconfigurationguidelinesandapply
identicalparametersettingsacrossallmodels.Choosingabasepre-trainedmodeloffersabalanced
trade-offbetweenperformanceandcomputationalefficiency,makingitsuitableforawiderange
ofreal-worldapplications.Basemodelsrequirelesscomputationalpowerandmemory,leading
tofastertrainingandinferencetimes,whichisbeneficialforresource-constrainedenvironments
andcost-effectivedeployment.Thus,weuseallthebaseversionsforeachpre-trainedmodel.We
fine-tunedallsixpre-trainedmodelstooptimizetheireffectivenessintheVulnTracetask.Each
modelwastrainedusingalearningrateof2e-5,withAdamWastheoptimizer,abatchsizeof32,
and10epochs.FollowingtheLOOCVapproach,duringeachiteration,themodelwastrainedon
fivedatasetswhilereservingonedatasetfortesting.
6 ExperimentalDesign
ToevaluatetheeffectivenessofVulnExtract inidentifyingVT,CPandAFfromNLvulnerability
artifacts,andVulnTraceinmappingtheseentitiestothecorrespondingcodesegments,wehave
formulatedthreeresearchquestions:
‚Ä¢ RQ2.Howdopre-trainedmodels(withandwithoutdiscoursepatterns),SVMmodels(with
andwithoutdiscoursepatterns),andapurelyheuristic-basedapproachcompareinclassifying
sentencesdescribingVT,CP,andAFinVulnExtract?
‚Ä¢ RQ3.Howeffectivearecodesearchmodelsintracingvulnerabilityartifactstorelevantcode
usingVulnTrace?
‚Ä¢ RQ4.HoweffectiveisVuleExtract+VulnTraceincombination?
ForRQ2,weemployLOOCVtoconduct6setsofexperiments,
‚Ä¢ Set1.Onlyapplyheuristicapproach
‚Ä¢ Set2.ApplytheSVMapproachwiththeinclusionofn-gramsasfeatures
‚Ä¢ Set3.ApplytheSVMapproachwiththeinclusionofdiscoursepatternsasfeatures
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:13
‚Ä¢ Set4.ApplytheSVMapproachwiththeinclusionofbothn-gramanddiscoursepatternsas
features
‚Ä¢ Set5.Onlyapplythepre-trainedmodelapproach
‚Ä¢ Set6.Applythepre-trainedmodelapproachwiththeinclusionofdiscoursepatternsas
features
ForRQ3andRQ4,weapplyLOOCVtotrainallpre-trainedcodesearchmodels.ForRQ3,we
useVulnExtract‚Äôsgroundtruth,andforRQ4,weusetheVT,CPandAFsentencesextractedby
VulnExtract assearchqueries,withthecodesnippetsoutputbyGitDiffservingaspotentialcode
mappingcandidates.
EvaluationMetrics.Wemeasureprecision,recall,andF1score toevaluatetheeffectiveness
ofVulnExtract inidentifyingsentencesdescribingVT,CPorAFfromNLvulnerabilityartifacts.
PrecisionisdefinedasthepercentageofsentencespredictedasVT/CP/AFthatarecorrectaccording
tothegoldset.RecallmeasuresthepercentageofVT/CP/AFsentencesthatarecorrectlypredicted.
TheF1score,whichistheharmonicmeanofprecisionandrecall,providesacombinedmeasureof
accuracy.
WeusetheTopK metrictoevaluatetheaccuracywithwhicheachVT,CPorAFsentencecan
bemappedtocodelinesappearingwithinthetopK resultsreturnedbyeachVulnTracemodel.
ConsideringVT,CP,andAFsentencesareextractedfrommultipleNLvulnerabilityartifactssothat
multiplesentencescouldconveythesamesemanticsandbemappedtothesamecodelines,we
claimthecodesearchbysuchgroupofsentenceswithequivalentsemanticsahit ifanysentence
inthegroupiscorrectlymappedtoanyoneofthecodelinesthatimplementthesemantics.
Recallthattheultimategoalofournoveltraceabilitymodelistotracebetweenapairofrelated
vulnerability entities extracted from NL artifacts to a pair of related code lines. Thus, we also
measuretheTopK accuracyofmappingsbetweensuchrelationpairs.Specifically,wecomputethe
TopK fortheAF/CP_CodeandVT/CP_Codemappings1generatedbyVulnTrace.HereAF/CP_Code
denotesamappingbetweenapairofrelatedAFandCPsentencesthatdescribethefixactionand
crashphenomenonofthesamevulnerabilitytoapairofcodelinesimplementingthecorresponding
semantics.Similarly,VT/CP_CodedenotesamappingbetweenapairofrelatedVTandCPsentences
thatdescribethetriggerandcrashphenomenonofthesamevulnerabilitytoapairofcodelines
implementingthecorrespondingsemantics.WeintroducetwovariantsoftheTopKmetric,assuming
aperfectandimperfectVulnExtract,respectively.Formula(1)evaluatesVulnTraceonthegoldset
(RQ3)whileformula(2)appliestoVuleExtract+VulnTracewherethefalsepositiveresultsreturned
byVuleExtract istakenintoaccount(RQ4):
(1) (cid:205) ùëñ ùëÅ =1 a ùëá ùëñ ¬∑cp ùëá ùëñ (2) (cid:205) ùëñ ùëÅ =1 aùëñ ¬∑cp ùëñ
(cid:205)ùëÅ A ùëá ¬∑CP ùëá (cid:205)ùëÅ (A ùëá +A ùêπ)¬∑(CP ùëá +CP ùêπ)
ùëñ=1 ùëñ ùëñ ùëñ=1 ùëñ ùëñ ùëñ ùëñ
where:
‚Ä¢ N:thetotalnumberofCVEs.
‚Ä¢ aùëñ:thenumberofcorrectmappingsbetweenrelevantAForVTsentences(truepositives)
identifiedbyVulnExtractandthecodestatementsfortheùëñ-thCVE.
‚Ä¢ cp:thenumberofcorrectmappingsbetweenrelevantCPsentences(truepositives)identified
ùëñ
byVulnExtractandthecodestatementsfortheùëñ-thCVE.
1Inourperformanceevaluation,wefocusexclusivelyonAF/CP_CodeandVT/CP_Code,excludingAF/VT_Code.Thisis
becauseVT_Codemappingstypicallycorrespondtocodedeletionsinapreviousfileversion,whileAF_Codemappings
generallyrepresentcodeadditionsinthenewerversion.Consequently,usingbothVTandAFcodelinesasentrypointsfor
staticanalysis(e.g.,datadependencyanalysis)isnotfeasible,astheentrypointsmustbepresentinthesameversionofthe
code.EvaluatingVulnTrace‚ÄôsperformanceonAF/VT_Codewould,therefore,notyieldmeaningfulinsightsandisomitted
fromouranalysis.
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:14 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
Table2. AverageVulnExtractperformanceforAF,VT,andCP.
AF VT CP
Approach Features
avg.P. avg.R. avg.F1 avg.P. avg.R. avg.F1 avg.P. avg.R. avg.F1
Heuristic patterns 84.16% 87.51% 85.67% 34.61% 100.00% 46.68% 92.19% 92.34% 92.18%
n-gram 84.78% 55.65% 66.73% 0.00% 0.00% 0.00% 86.58% 67.02% 74.65%
SVM patterns 94.84% 91.03% 92.80% 69.32% 40.20% 47.37% 96.48% 95.01% 95.60%
n-gram+patterns 94.56% 89.95% 92.16% 66.67% 40.20% 47.08% 96.36% 90.92% 93.42%
- 75.44% 78.69% 77.07% 15.00% 7.06% 7.43% 85.75% 82.08% 83.51%
BERT
patterns 79.97% 84.12% 81.56% 49.40% 28.36% 28.02% 86.51% 87.75% 86.89%
- 77.85% 84.68% 80.52% 17.78% 8.18% 9.01% 84.28% 86.99% 84.78%
DistilBERT
patterns 78.83% 87.05% 82.29% 31.13% 13.66% 18.23% 84.97% 85.88% 85.00%
- 77.62% 86.50% 81.72% 19.45% 9.29% 10.63% 84.79% 84.09% 84.00%
ELECTRA
patterns 81.34% 82.24% 81.46% 46.27% 23.70% 31.92% 89.83% 80.34% 84.21%
- 75.98% 88.21% 81.56% 19.45% 7.46% 8.89% 85.66% 84.67% 84.84%
SpanBERT
patterns 79.22% 86.60% 82.53% 42.55% 23.19% 20.44% 85.69% 90.66% 87.83%
- 79.42% 85.36% 82.14% 17.22% 8.18% 8.49% 85.32% 85.27% 84.74%
RoBERTa
patterns 75.77% 88.38% 81.46% 52.32% 29.95% 33.35% 86.68% 90.49% 88.01%
‚Ä¢ a ùëá :thenumberofcorrectmappingsbetweenallAForVTsentencesinthegoldsetandthe
ùëñ
codestatementsfortheùëñ-thCVE.
‚Ä¢ cp ùëá :thenumberofcorrectmappingsbetweenallrelevantCPsentencesinthegoldsetand
ùëñ
thecodestatementsfortheùëñ-thCVE.
‚Ä¢ A ùëá :thetotalnumberofmappingsbetweenAForVTsentencesandcodestatementsinthe
ùëñ
goldsetfortheùëñ-thCVE.
‚Ä¢ A ùêπ :thenumberofAForVTsentencesincorrectlyidentifiedbyVulnExtract(falsepositives)
ùëñ
fortheùëñ-thCVE.
‚Ä¢ CP ùëá :thetotalnumberofmappingsbetweenCPdescriptionsandcodestatementsinthegold
ùëñ
setfortheùëñ-thCVE.
‚Ä¢ CP ùêπ :thenumberofCPsentencesincorrectlyidentifiedbyVulnExtract(falsepositives)for
ùëñ
theùëñ-thCVE.
Informula(1),thenumeratorcountsthetotalnumberofcorrectlyidentifiedrelationshipmap-
pingsforAF/CP_CodeorVT/CP_CodeinallCVEs.Thedenominatorcountsthetotalnumber
ofrelationshipmappingsforAF/CP_CodeorVT/CP_CodeinallCVEsinthegoldset.Thekey
differenceofnumeratorsbetweenformula(1) and(2) lieintheinputsourceofVT,CPandAF
sentences to VulnTrace. Formula (1) applies when VulnTrace takes the input of VT, CP and AF
sentencesfromthegoldset.Formula(2)applieswhenVulnTracetakestheinputofVT,CPandAF
sentencescorrectlyidentifiedbyVulnExtract.Additionally,informula(2),thedenominatorcounts
notonlyalltherelationshipmappingsinthegoldsetbutalsoAFandVTsentencesincorrectly
identifiedforeachCVE(falsepositives)byVulnExtract.
7 Evaluation
7.1 ResultsofHeuristics,SVM,andPre-trainedModelsinVulnExtract(RQ2)
Table2presentstheaverageresultsofthreedifferentapproachesinVulnExtract:theheuristic
approach(row2),SVM-basedmodels(rows3-5),andpre-trainedmodels(rows6-15).Therows
labeled"patterns"indicatethatdiscoursepatternswereincludedasfeaturesinthosemodels.
Overall,SVM+patterns(row4)achievedthehighestF1-scoresforAFandCP,reaching92.8%
and 95.6%, respectively. However, all models struggled with VT classification, with F1-scores
remainingbelow50%.Theheuristicapproachachievedperfectrecall(100%)forVT,similarto
SVM+patterns,butwithlowerprecision.Below,weanalyzeeachapproachindetail.
7.1.1 HeuristicApproach. TheheuristicapproachdemonstratedstrongperformanceforAF(85.67%
F1)andCP(92.18%F1),butitseffectivenessinVTclassificationwaslower,achievinganF1-scoreof
only46.68%.ThekeyadvantageoftheheuristicapproachisitshighrecallforVT(100%),ensuring
thatallVTinstancesareretrieved.Highrecallisparticularlyusefulintraceabilitymodels,where
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:15
missingrelevantlinkscouldnegativelyimpacttaskssuchasbug-fixidentificationandvulnerability
management[12,51].
ThelowerprecisionforVTcanbeattributedtotherelativelysmallnumberofVTinstances(82)
comparedtoAF(780)andCP(808).Vulnerabilityartifactstendtofocusmoreonbugfixesand
crashdescriptionsratherthantherootcausesofvulnerabilities[63],makingVThardertoidentify.
Toensurebroadapplicability,theheuristicpatternforVTwasdesignedinageneralizedmanner.
Thisgeneralizationexplainswhyrecallreaches100%,asthebroaderpatternscapturemostVT
instances,thoughsometimesatthecostofspecificity.
Togainfurtherinsights,weanalyzedfalsepositivesinVTclassification.Aprominentcategoryof
falsepositivesincludessentencesbeginningwith‚ÄúFix.‚Äù Thesetypicallydescribepatches,corrective
actions,orpreventivemeasuresratherthantherootcauseofavulnerability.Forexample,inBinu-
tils,‚ÄúFixincorrectescapesequencehandling.‚Äù statesthatafixwasappliedbutdoesnotexplainhow
theissuearose.Similarly,inFFmpeg,‚ÄúFixsmallpictureupscale.‚Äù referstoasurface-levelcorrection
rather than the vulnerability trigger. These misclassifications occur because heuristic patterns
capturecorrectiveactionsbutdonotdistinguishbetweenpatchesandrootcauseexplanations.
Whilefixinganissueispartofremediation,VTtypicallydescribeshowavulnerabilityemerged,
whatfaultylogicallowedit,orthepreconditionsthatledtoitsexploitability.Sentencesstating
onlythatsomethingwas‚Äúfixed‚Äù lackthiscontext,leadingtoincorrectVTclassification.Beyond
sentencesbeginningwith‚ÄúFix.‚Äù,weidentifiedotherfalsepositiveswheretheheuristicapproach
misclassifiedcodemaintenanceactionsorspeculativesystembehaviorsasVT.Forexample,in
FFmpeg,‚ÄúClearpointersinallocate_buffers().‚Äù describesaroutinecleanupwithoutindicatinghow
aflawwasintroducedorexploited.Similarly,inlibarchive,‚ÄúFuzzingwithCRCsdisabledrevealed
thatacalltoget_uncompressed_data()wouldsometimesfail.‚Äù wasmisclassifiedduetoitsconditional
phrasing,despitelackingdetailsonthevulnerability‚Äôsorigin.Thesecaseshighlightthechallengeof
distinguishingbetweenrootcauseindicatorsandbroadersystembehaviors.Whilecertainkeywords
suggestvulnerabilityrelevance,correctlyidentifyingVTrequiresrecognizingwhetherasentence
explicitlydescribeshowavulnerabilityarises,ratherthanjustitssymptomsorremediation.
7.1.2 SVMs. Rows3-5inTable2showtheresultsforthreeSVM-basedmodelsthatusedifferent
featuresets:n-gramfeaturesonly,pattern-basedfeaturesonly,andacombinationofboth.The
SVM+patternsmodel(row4)achievedthehighestF1scoresforAF(92.8%)andCP(95.6%),
confirmingthatincorporatingdiscoursepatternssignificantlyenhancesclassificationperformance.
However,VTclassificationremainedachallenge,withanF1-scoreof47.37%.
Notably, SVM + n-grams alone (row 3) failed to retrieve any correct VT instances, leading
toanF1-scoreof0%.ThisisduetotheimbalancebetweentruepositiveandtruenegativeVT
instances,wherethescarcityofpositiveVTsamplesleadstobiasedlearning.Comparedtothe
heuristicapproach,SVM+patternsachievedhigherprecisionforAFandCPbuttradedoffrecall,
highlightingtheprecision-recalltrade-offbetweenheuristicsandmachinelearningmodels.
TofurtherunderstandSVMmodellimitations,weexaminedfalsepositivesandfalsenegatives.
ThefalsepositivesrevealedthatSVM+patternssufferedfromthesamemisclassificationissues
observedintheheuristicapproach,reinforcingtheideathatVTidentificationischallengingdueto
insufficientinformationinvulnerabilityartifacts.Falsenegativesweremorevariedacrossprojects.
InBinutils,‚ÄúWhen‚Äòuvalue‚Äôisaspecificvalue,‚Äòblock_start+uvalue‚Äôwillcauseintegeroverflow.‚Äù was
overlooked,likelyduetoitsnumericalnature,whichlacksexplicitvulnerabilityterms.InFFmpeg,
‚ÄúFailuretoverifycausestotal_size>atom.sizewhichwillresultinnegativesizecalculationslater
on.‚Äù wasmissedasitdescribesaneventualfailureratherthanexplicitlylinkingtoavulnerability.
Similarly,inTcpdump,‚ÄúTheboundscheckinesis_print()testedonepointeratthebeginningofaloop
thatincrementedanother.‚Äù wasmisclassified,suggestingdifficultyindetectingvulnerabilitiesarising
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:16 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
Table3. AverageVulnTraceonlyexperimentalresultsforVT_Code,AF_CodeandCP_Code.
avg.VT_Code% avg.AF_Code% avg.CP_Code%
Approach
top1 top2 top3 top4 top5 top1 top2 top3 top4 top5 top1 top2 top3 top4 top5
UniXCoder 11.63 16.74 33.64 51.87 72.57 17.61 34.86 49.15 63.34 77.62 9.31 25.86 48.28 64.02 81.72
CoCoSoDa 11.63 14.55 22.90 34.71 48.51 9.12 20.06 31.73 42.70 55.16 8.30 22.01 30.81 42.88 56.15
GraphCodeBERT 6.95 18.73 33.27 39.34 66.23 3.68 10.36 25.45 39.19 51.86 9.12 18.51 39.83 57.03 68.73
CodeBERT 4.27 13.61 34.11 57.81 66.28 5.81 13.51 26.73 43.67 59.69 14.51 26.40 40.47 55.16 74.36
RoBERTa 4.18 10.93 31.79 52.25 60.85 6.77 16.47 29.87 42.52 61.46 11.82 24.70 39.08 56.02 72.28
RoBERTa-Code 10.53 16.47 25.02 41.62 69.65 6.11 13.22 27.29 40.95 58.98 16.73 27.76 42.19 55.63 73.05
Table4. AverageVulnTraceonlyexperimentalresultsforVT/CP_CodeandAF/CP_Code.
avg.VT/CP_Code avg.AF/CP_Code
Approach
top1 top2 top3 top4 top5 top1 top2 top3 top4 top5
UniXCoder 4.77% 8.81% 23.19% 35.10% 68.20% 2.43% 12.22% 26.19% 42.02% 68.33%
CoCoSoDa 2.39% 7.05% 16.96% 30.26% 47.16% 1.36% 6.14% 13.50% 26.97% 41.92%
GraphCodeBERT 0.88% 10.85% 30.02% 34.32% 65.94% 0.65% 3.54% 16.40% 28.12% 41.38%
CodeBERT 0.00% 5.21% 18.67% 43.93% 60.71% 1.58% 5.01% 16.93% 34.59% 52.32%
RoBERTa 2.07% 4.16% 21.68% 34.94% 50.04% 1.43% 9.27% 24.20% 33.77% 50.11%
RoBERTa-Code 2.51% 5.46% 10.66% 33.08% 65.12% 2.23% 4.92% 12.60% 30.07% 49.56%
fromcomplexinteractionsratherthanisolatedoperations.Thesecaseshighlightthechallengeof
identifyingVTinstancesthatrelyonimplicitdescriptionsortechnicalconditions.
7.1.3 Pre-trainedModels. Rows6-15inTable2presenttheresultsforsixpre-trainedmodels.A
fewpointsdeservemention.First,comparingtheresultsofthepre-trainedmodelswiththeSVM
resultswhendiscoursepatternsarenotused(i.e.,fortheSVMs,onlyn-gramsareusedasinput,
andforthepre-trainedmodels,onlytheinputwordsequenceisused),wecanseethatallofthe
pre-trainedmodelssubstantiallyoutperformtheSVMs.Thisisperhapsnotsurprising:unlikethe
SVMs,wheretheone-hotfeaturerepresentationscaptureonlylexicalknowledge,thedistributed
representationsusedbythepre-trainedmodelscapturesemanticknowledgeandprovidebetter
generalizationsthantheirone-hotcounterparts.
Second,whendiscoursepatternsareaddedtothepre-trainedmodels,weseeanincreasein
averageF1-scoresinamajorityofcases.Amongthesecases,weseeincreasesinrecallaccompanied
bysmallerdropsinprecision.Thisisperhapsnotsurprisingeither:thediscoursepatternsprovide
furthergeneralizationsbeyondwhatcanbelearnedfromthetrainingdata,thushelpingtoboost
recall.Fortheremainingcases,theadditionofdiscoursepatternscausesthepre-trainedmodelsto
performeitheratthesamelevelormarginallyworse,andthesearetypicallythecaseswhenthe
discoursepatternsfailtoimproverecall.
Finally,comparingtheresultsofthepre-trainedmodelsandthoseoftheSVMswhendiscourse
patterns are added, we see that the SVMs substantially outperform the pre-trained models. In
otherwords,theincorporationofthediscoursepatternsofferssubstantialimprovementstothe
SVMs,buttheirimpactonthepre-trainedmodelsisonlymodestatbest.Thereasonisthatthe
n-gramsarelesssparseandlesscorrelatedwiththeclasslabels,thusmakingiteasyfortheSVMs
toidentifythemasnotbeinguseful(inthepresenceofthediscoursepatterns),allowingtheSVMs
torelymostlyonthediscoursepatternswhenmakingclassificationdecisions.Incomparisonto
then-grams,thedensewordvectorsusedbythepre-trainedmodelsarenotsparseandaremore
correlatedwiththeclasslabels.Thismakesithardforthepre-trainedmodelstofocuslargelyon
thediscoursepatternsandignorethewordvectorswhenmakingdecisions.Inotherwords,the
relianceonthewordvectorshasmoderatedthe(positive)effectofthediscoursepatternsinthe
pre-trainedmodels.
7.2 PerformanceofCodeSearchModelsinVulnTrace(RQ3)
Table3providesadetailedcomparisonofdifferentcodesearchmodels(UniXCoder,CoCoSoDa,
GraphCodeBERT,CodeBERT,RoBERTa,andRoBERTa-Code)basedontheiraverageperformance
amongallprogramsinmappingsinglesentence(VT,AF,CP)tocorrespondingcodesegments.The
modelsareevaluatedacrossdifferentperformancelevels(top1-top5).WefindthatUniXCoder
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:17
Table5. AverageVulnExtractandVulnTracecombinedexperimentalresultforVT_Code,AF_CodeandCP_Code.
avg.VT_Code% avg.AF_Code% avg.CP_Code%
Approach
top1 top2 top3 top4 top5 top1 top2 top3 top4 top5 top1 top2 top3 top4 top5
UniXCoder 10.82 14.54 28.71 46.81 64.0 14.36 29.93 42.32 53.68 66.74 10.14 24.53 44.46 56.71 72.03
CoCoSoDa 10.82 13.07 20.67 30.40 43.42 7.56 17.18 27.43 37.50 48.01 7.93 19.36 27.43 38.71 50.87
GraphCodeBERT 6.24 14.68 28.48 33.64 58.97 2.71 8.95 20.95 33.19 44.46 8.56 17.45 37.84 52.41 63.05
CodeBERT 2.31 7.76 27.97 50.76 59.09 4.75 11.90 23.95 38.92 52.76 13.57 24.54 37.78 51.14 67.95
RoBERTa 4.05 9.38 26.93 46.62 53.73 5.45 14.34 25.07 36.71 53.28 11.05 22.92 36.20 51.98 65.97
RoBERTa-Code 9.08 13.03 20.02 35.78 61.75 5.25 11.34 23.65 36.21 51.22 15.55 26.07 39.53 51.67 66.82
Table6. AverageVulnExtractandVulnTracecombinedexperimentalresultsforVT/CP_CodeandAF/CP_Code.
avg.VT/CP_Code avg.AF/CP_Code
Approach
top1 top2 top3 top4 top5 top1 top2 top3 top4 top5
UniXCoder 4.66% 6.88% 19.54% 29.99% 59.60% 1.99% 9.66% 21.62% 33.56% 53.10%
CoCoSoDa 2.27% 5.36% 14.67% 25.90% 42.27% 1.08% 5.02% 11.04% 22.46% 33.00%
GraphCodeBERT 0.76% 9.49% 27.01% 30.53% 57.28% 0.42% 2.98% 12.35% 21.72% 32.83%
CodeBERT 0.0% 3.97% 14.82% 36.31% 52.32% 1.08% 3.87% 14.23% 28.11% 41.27%
RoBERTa 1.95% 3.69% 19.85% 31.50% 43.82% 0.84% 7.19% 18.51% 26.09% 39.19%
RoBERTa-Code 2.33% 4.93% 9.0% 29.05% 57.45% 1.75% 4.11% 10.61% 25.77% 39.57%
outperformstheothermodelsacrossmostoftheentitytypesinTable3,particularlyduetoits
cross-modalpre-trainingthatefficientlyhandlesbothnaturallanguageandcode.Thistraining
allowsUniXCodertoalignvulnerability-relatedtextartifacts(likecommitmessages)withtheir
correspondingcodemoreeffectivelythanmodelsfocusedoneithercodeortextindependently.
Themodel‚ÄôshighestperformanceisinCPtocodemapping(81.72%intop-5),demonstratingits
abilitytocapturecomplexcausalrelationshipsbetweenvulnerabilitydescriptionsandcode.Its
strongperformanceinAFtocodemapping(77.62%intop-5)canalsobeattributedtoitsabilityto
bridgethesemanticgapbetweenafter-fixdescriptionsandthecorrespondingcode.Eventhough
itsVTtocodeperformance(72.57%intop-5)isslightlylower,UniXCodermaintainsconsistent
resultsacrossallentitytypes.
Incomparison,CoCoSoDaleveragescontrastivelearningtodifferentiatebetweensimilarcode
snippets,whichhelpsinAFandCPmappingbutfallsshortinVTtocode(48.51%),likelybecause
itisnotoptimizedformappingvulnerabilitytriggerseffectively.CodeBERT,thoughdesigned
forbothcodeandtext,lacksthefine-grainedcross-modaltrainingofUniXCoder,leadingtolower
performance,particularlyinAFtocode(59.69%).WhileRoBERTaisarobustpre-trainedlanguage
model,itunderperformsincode-specifictasksduetoitsfocusonnaturallanguageratherthan
programminglanguages.Ontheotherhand,RoBERTa-Code,whichhasundergonecode-specific
fine-tuning,showsimprovementsinCPtocode(73.05%intop-5),butstilltrailsbehindUniXCoder.
ThisgaparisesbecauseCodexGlue,whileadaptedforcode,doesnotfullybridgethegapbetween
vulnerability-specifictextandcodemappingaseffectivelyasUniXCoder‚Äôscross-modalpre-training,
whichisdesignedtohandlebothnaturallanguageandcodemoreseamlessly.
Table4presentstheperformanceofpairwisesentence-to-codepairmappingforVT/CP_Code
andAF/CP_Code.Giventhattheperformanceofthesepairwisemappingsisinherentlytiedto
the individual VT, AF, and CP to Code mappings (as outlined in the Evaluation Metrics), it is
expectedthatUniXCoder,withitssuperiorresultsinsingle-entitymappings,outperformsallother
codesearchmodelsintop5accuracy,reachingover68.20%intop5forbothVT/CP_Codeand
AF/CP_Code.
7.3 PerformanceofVuleExtract+VulnTrace(RQ4)
ForourevaluationofRQ4,weprioritizedrecallinselectingthemosteffectiveapproachforVulnEx-
tract,ashighrecalliscrucialwhendealingwithsoftwarevulnerabilities.EnsuringthatVulnExtract
identifiesasmanyrelevantentitiesaspossibleiskeytounderstandingandaddressingpotential
securityrisks[41,52,54].BasedontheresultsinTable2,weoptedtousetheSVM+patternsVul-
nExtractoutputforAFandCP,whichyieldedstrongrecallscoresof91.03%and95.01%,respectively.
ForVT,wechosetheheuristicVulnExtractapproach,asitachievedaperfectrecallof100%.These
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:18 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
choicesreflectourfocusonmaximizingtheidentificationofvulnerability-relatedentities,which
directlyimpactstheoveralleffectivenessoftheVulnTracesystem.
AsshowninTable5,UniXCoderoutperformedtheothermodelsacrossVT_Code,AF_Code,and
CP_Codeinmosttop-kcategories.Inparticular,UniXCoderachieved14.36%accuracyfortop-1
AF_Codematchingand66.74%fortop-5AF_Codematching,indicatingthatitishighlyeffective
atretrievingthecorrectcoderelatedtoAFvulnerabilities.Itsstrongperformancecontinueswith
top-5CP_Coderetrieval,reaching72.03%andtop-5VT_Codereaching64.0%,whichhighlightsits
abilitytoidentifycriticalcodeforAF,CPandVTentities.RoBERTa-Codealsoshowedcompetitive
results,particularlyforVT_Codeachieving61.75%fortop-5.However,itfallsbehindUniXCoder
inAF_CodeandCP_Coderetrieval,indicatingthatwhiletheycanbeeffectiveincertaincontexts
(e.g.,VT_Code),theiroverallutilityinidentifyingvulnerability-relatedcodemaybemorelimited
whenAFandCPentitiesareconsidered.
Table6highlightsthecombinedperformanceforVT/CP_CodeandAF/CP_Code.UniXCoder
onceagainstandsoutwiththehighesttop-5scoresforbothVT/CP_Code(59.60%)andAF/CP_Code
(53.10%).TheseresultsindicatethatUniXCoderisthemostsuitablepre-trainedmodelforthecode
searchtasksinVulnTrace.Trainedonbothnaturallanguageandprogramminglanguagesusing
across-modalpre-trainingapproach,UniXCoderleveragesitsunderstandingofcodesemantics
andstructure,makingitparticularlyeffectiveforidentifyingvulnerability-relatedcodesnippetsin
staticanalysis.Furthermore,theseresultsdemonstratethatthecombinationofVulnExtractand
VulnTraceishighlyeffectiveinidentifyingandtracingawiderangeofvulnerabilities.Byleveraging
VulnExtract‚Äôshighrecallforextractingpairsofvulnerability-relatedentitiesandVulnTrace‚Äôsability
tomapthoseentitiestorelevantcodelines,thisapproachoffersacomprehensiveandreliable
solutionforstaticvulnerabilitytracingincomplexsoftwaresystems.
Implication. Wedesignedacontrolledexperimenttoevaluatetheimpactofourtoolonvulner-
abilitycomprehensionwhileensuringfairnessamongparticipants.SixComputerSciencePh.D.
studentsparticipatedinthestudy,completingthetaskundertwoconditions:withouttoolsupport
(GroupA)andwithtoolsupport(GroupB).Toensurefairnessandminimizetheinfluenceof
priorknowledge,eachparticipantperformedthetaskwithdifferentCVEsetsinthetwoconditions,
allowingforabalancedcomparison.Atotalof40CVEswereselectedforthestudy‚Äîsixrandomly
chosen from each project and four from the full dataset. The 40 CVEs used in the study were
dividedintosixparts,withthefirsttwopartscontaining10CVEseachandtheremainingfour
parts containing 5 CVEs each. Each student was assigned one part in Group A and a different
partinGroupB,ensuringthatnoparticipantanalyzedthesameCVEsinbothconditions.This
setupallowedallparticipantstoexperiencebothexperimentalconditionswhileavoidingrepeated
exposuretothesamevulnerabilities.Eachparticipantwasprovidedwithvulnerability-related
artifacts,includingtheCVEsummary,bugreport,commitmessage,andcodesnippets.Theirtask
wastoidentifyVT(VulnerabilityTrigger),CP(CrashPhenomenon),andAF(After-Fix)foreach
CVEandmapthemtothecorrespondingcodelines.Afterward,theywererequiredtowriteaFix
SummarythatintegratedVT,CP,andAFwiththeirmappedcodelines.Theprocedurefollowedby
eachgroupisdescribedbelow:
‚Ä¢ GroupA(Baseline,withouttoolsupport):
‚Äì Manuallyexaminedallartifacts.
‚Äì Carefullyreadandanalyzedallavailableinformation.
‚Äì IdentifiedVT,CP,andAFalongwiththeircorrespondingmappedcodelines.
‚Äì ComposedtheFixSummarybasedontheirmanualunderstanding.
‚Ä¢ GroupB(Withtoolsupport):
‚Äì Reviewedartifactsbutskippedlengthysectionswhenapplicable.
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:19
‚Äì ReliedonVT,CP,andAFsentencesextractedbyVulnExtracttoformaninitialunderstand-
ing.
‚Äì Usedtop5mappedcodestatementsfromVulnTracetolocaterelevantcodeefficiently.
‚Äì Cross-verifiedextractedinformationwiththeartifactsandfinalizedtheirFixSummary.
EachstudentrecordedthetotaltimespentperCVE,includingartifactanalysisandsummary
writing.Twoauthorsindependentlyevaluatedtheirperformancebasedon:
‚Ä¢ CorrectidentificationofVT,CP,andAFwithmappedcodelines(3points).
‚Ä¢ CompletenessandclarityoftheFixSummary(2points).
Thefinalscorewasdeterminedbyaveragingthetwoauthors‚Äôratings.Theresultsdemonstrate
thatourtoolcouldimprovebothefficiencyandaccuracyinvulnerabilitycomprehension.Partici-
pantsinGroupAspentanaverageof7.09minutesperCVEandachievedanaveragescoreof3.46.
Incontrast,GroupB,aidedbyourtool,reducedanalysistimeto3.44minuteswhileimprovingtheir
performancescoreto3.88.Thesefindingssuggestthatourtoolmayhelpusersnavigateextensive
NLartifactsmoreefficiently,allowingthemtofocusonkeyvulnerability-relevantinformation.By
localizingbug-fix-relatedtextandlinkingittocorrespondingcode,thetoolreducesmanualeffort
andimprovescomprehension.
8 ThreatstoValidity
Aprimarythreattoconstructvalidityliesinthesubjectivityinvolvedindiscoursepatternextraction
andthelabelingofvulnerabilityentities(AF,VT,CP).Tomitigatethis,weimplementedarigorous
annotationprocess(Section4.1),wheretwoindependentcoderslabeledeachsentence.Weassessed
codingreliabilityusinginter-rateragreementmetrics,achievingCohen‚ÄôsKappavaluesof0.83,
0.84,and0.84forAF,VT,andCP,respectively,asdetailedin(Section4.1.3).Disagreementswere
reviewed collaboratively to ensure consensus and minimize subjectivity. Regarding discourse
patternextraction,ourprocessadheredtoopencodingpractices[10],whichemphasizeiterative
analysisandrefinementtoreducecoderbiasandimproveconsistency.
InternalvaliditythreatsprimarilyconcerntheimplementationofVulnTraceandthepotential
influenceofthevariedperformanceofdifferentcodesearchmodels.Toaddressthis,weevaluated
sixstate-of-the-artpre-trainedmodels(Section5.2).Byusingmultiplemodelsandreportingaverage
results,wemitigatedtheriskofoverfittingorbiasintroducedbyanyspecificmodel.
Externalvaliditypertainstothegeneralizabilityofourfindings.Althoughourdatasetincludes
vulnerabilitiesextractedfromexistingCVEs,thesevulnerabilitiesmaynotcomprehensivelyrep-
resentallpossiblesoftwarevulnerabilities.Toenhancegeneralizability,weadoptedanLOOCV
strategyacrosssixdiverseopen-sourcedatasets.Thisapproachhelpedensurethatidentifiedpat-
terns generalize well across projects and reduced the risk of overfitting to any single dataset.
Nevertheless,weacknowledgethislimitationandsuggestthatfuturestudiesexpandthedatasetto
includevulnerabilitiesdiscoveredthroughadditionalmethods.
9 RelatedWork
Analyzing vulnerabilities in natural language artifacts: Several studies have focused on
analyzingnaturallanguageartifactssuchasbugreports,CVEsummaries,andcommitmessages
to identify bug-fix patterns and improve the bug resolution process [5, 22, 39, 44, 64, 67]. One
ofthefoundationalworksinvestigatesthekeyattributesofhigh-qualitybugreportsandtheir
relationtotheresolutionofsoftwarevulnerabilities.Ithighlightshowwell-writtenbugreports
canleadtofasterandmoreeffectivefixes[5].Similarly,thestudyexamineshownaturallanguage
discussionsinbugreportscontributevaluablecontexttothebug-fixingprocess[44].Gousiosetal.
exploreshowemotionalvariationsincommitmessagescanprovideearlyindicatorsofpotential
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:20 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
vulnerabilities[22].Thesestudiesunderscoretheimportanceofleveragingnaturallanguageartifacts
inunderstandingandresolvingsoftwarevulnerabilities.Ourapproach,VulnExtract,automatesthe
extractionofkeyvulnerabilityentities‚ÄîVT,CPandAF,fromsuchartifacts,whilecapturingthe
relationshipsbetweenapairofentities.
Analyzingvulnerabilitiesincodeorextractingcodepatterns:Codeanalysisiscrucialin
identifyingpatternsassociatedwithvulnerabilitiesandtheircorrespondingfixes[7‚Äì9,34,40,42,49].
Nguyenetal.presentalarge-scaleempiricalstudyofcommonbug-fixpatterns,identifyingpatterns
that frequently resolve vulnerabilities in code [8]. Zhong et al. compare vulnerability-specific
patcheswithgeneralbugfixes,showingthatsecuritypatchesofteninvolveuniquecodepatterns[7].
These works highlight the need for understanding code patterns to effectively address and fix
securityvulnerabilities[7‚Äì9,34,40,42,49].Ourapproach,VulnTrace,automaticallytracesapairof
relatedvulnerabilityentities(VT,CP,AF)innaturallanguageartifactstotheircorrespondingcode
segmentstorecoverthesemanticrelationshipbetweenlinesofcode.
Traditionaltraceabilitymodelsfromnaturallanguageartifactsandcode: Traditional
traceabilitymodelsprimarilyestablish/recovertracinglinksbetweenindividualentities,suchas
betweenrequirementsorbugreportsandcorrespondingcodesegments[5,11,46,61].Bettenburgel
at.exploreshowbugreportscanbelinkedtotheircorrespondingcodefixes,layingthefoundation
fortraceabilitymodelsthatfocusonone-to-onemappings[5].VCMatchproposesamethodfor
linkingsecuritypatchestotheircorrespondingvulnerabilities,layingthefoundationfortraceability
modelsfocusingonone-to-onemappingsbetweenartifactsandcode[61].
Whilethesestudieshaveadvancedourunderstandingoftraceabilitymodels,theyarelimitedto
single-entity-to-codemappings[5,11,46,61].Incontrast,ourapproachextendsthesetraditional
modelsbyfocusingonpairsofentityrelationships,suchasVT/CPandAF/CP,andmappingthem
tocorrespondingrelatedlinesofcode.Thisenhancestheabilitytotrackandunderstandbugfixes
moreefficiently,expandingthescopeoftraceabilitymodelsinthecontextofsecurityvulnerabilities.
10 ConclusionsandFutureWork
ThispaperintroducesatraceabilitymodelthatlinksapairofsentencesdescribingVT,CPand
AFtotheircorrespondingpairofcodestatementsfacilitatingadeeperunderstandingofhowand
whyvulnerabilitiesarefixed.Ourempiricalstudy,basedon341CVEsandtheirassociatedcode
snippets,demonstratestheeffectivenessofourapproach,withrecallexceeding90%inmostcases
forNLsentenceextraction.Theend-to-endcombinedVulnExtract+VulnTraceachievesaTop5
accuracyof59.6%and53.1%formappingtwopairsofNLsentencestocodestatements.Future
workwillexplorefurtheroptimizationoftheVulnTracemodel,focusingonimprovingitshandling
ofcomplexandabstractNLvulnerabilitydescriptionssuchasVT.Additionally,weaimtoextend
themodel‚Äôsapplicabilitytootherdomainsandsoftwaresystems,enhancingitsrobustnessand
scalabilityforlarge-scalereal-worldapplications.
DataAvailability
Thereplicationpackageofthisworkandadditionalexperimentresultsareavailableat[16].We
willmaketheimplementationanddatapubliclyavailableuponacceptance.
Acknowledgments
ThisworkwaspartlysupportedbyNSFgrantsCCF-2008905andCCF-2047682.WethankRuiqiHu,
CanonEllis,SabrinaAlam,andGeorgeSammitfromSouthernMethodistUniversity,aswellas
MohammadRafieianandMeahTahmeedAhmedfromtheUniversityofTexasatDallas,fortheir
contributionstotheimplicationstudy.
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:21
References
[1] 2017.CVE-2017-12893.AvailablefromMITRE,CVE-IDCVE-2017-12893. https://cve.mitre.org/cgi-bin/cvename.cgi?
name=CVE-2017-12893Accessed:2024-09-12.
[2] 2024.CommonVulnerabilitiesandExposures(CVE).https://cve.mitre.org/. Accessed:2024-09-12.
[3] MansourAhmadi,RezaMirzazadefarkhani,RyanWilliams,andLongLu.2021. FindingBugsUsingYourOwn
Code:DetectingFunctionally-similaryetInconsistentCode.In30thUSENIXSecuritySymposium(USENIXSecurity21).
USENIXAssociation,2025‚Äì2040. https://www.usenix.org/conference/usenixsecurity21/presentation/ahmadi
[4] DavidM.Allen.1974.TheRelationshipbetweenVariableSelectionandDataAgumentationandaMethodforPrediction.
Technometrics16,1(1974),125‚Äì127. doi:10.2307/1267500
[5] NicolasBettenburg,SaschaJust,AdrianSchr√∂ter,CathrinWeiss,RahulPremraj,andThomasZimmermann.2008.
Whatmakesagoodbugreport?.InProceedingsofthe16thACMSIGSOFTInternationalSymposiumonFoundationsof
SoftwareEngineering(Atlanta,Georgia)(SIGSOFT‚Äô08/FSE-16).AssociationforComputingMachinery,NewYork,NY,
USA,308‚Äì318. doi:10.1145/1453101.1453146
[6] S.Bird,E.Klein,andE.Loper.2009.NaturalLanguageProcessingwithPython.O‚ÄôReillyMediaInc. https://www.nltk.
org/book/Accessed:2024-07-25.
[7] Quang-CuongBui,RanindyaParamitha,Duc-LyVu,FabioMassacci,andRiccardoScandariato.2023.APR4Vul:an
empiricalstudyofautomaticprogramrepairtechniquesonreal-worldJavavulnerabilities.EmpiricalSoftw.Engg.29,1
(dec2023),40pages. doi:10.1007/s10664-023-10415-7
[8] EduardoCunhaCamposandMarcelodeAlmeidaMaia.2017.CommonBug-FixPatterns:ALarge-ScaleObservational
Study.In2017ACM/IEEEInternationalSymposiumonEmpiricalSoftwareEngineeringandMeasurement(ESEM).404‚Äì413.
doi:10.1109/ESEM.2017.55
[9] GerardoCanfora,AndreaDiSorbo,SaraForootani,MatiasMartinez,andCorradoA.Visaggio.2022.Patchworking:
Exploringthecodechangesinducedbyvulnerabilityfixingactivities.Inf.Softw.Technol.142,C(feb2022),13pages.
doi:10.1016/j.infsof.2021.106745
[10] OscarChaparro,JingLu,FiorellaZampetti,LauraMoreno,MassimilianoDiPenta,AndrianMarcus,GabrieleBavota,
andVincentNg.2017.Detectingmissinginformationinbugdescriptions.InProceedingsofthe201711thJointMeeting
onFoundationsofSoftwareEngineering(Paderborn,Germany)(ESEC/FSE2017).AssociationforComputingMachinery,
NewYork,NY,USA,396‚Äì407. doi:10.1145/3106237.3106285
[11] SofiaCharalampidou,ApostolosAmpatzoglou,EvangelosKarountzos,andParisAvgeriou.2021.Empiricalstudieson
softwaretraceability:Amappingstudy.J.Softw.Evol.Process33,2(feb2021),28pages. doi:10.1002/smr.2294
[12] JaneCleland-Huang,OrlenaGotel,andAndreaZisman.2012.SoftwareandSystemsTraceability.SpringerPublishing
Company,Incorporated.
[13] HuggingFace.2024.BERTModelandTokenizer.https://huggingface.co/bert-base-uncased. Accessed:July23,2024.
[14] HuggingFace.2024.DistilBERTModelandTokenizer.https://huggingface.co/distilbert-base-uncased. Accessed:July
23,2024.
[15] ZhangyinFeng,DayaGuo,DuyuTang,NanDuan,XiaochengFeng,MingGong,LinjunShou,BingQin,TingLiu,
DaxinJiang,andMingZhou.2020. CodeBERT:APre-TrainedModelforProgrammingandNaturalLanguages.In
FindingsoftheAssociationforComputationalLinguistics:EMNLP2020,TrevorCohn,YulanHe,andYangLiu(Eds.).
AssociationforComputationalLinguistics,Online,1536‚Äì1547.doi:10.18653/v1/2020.findings-emnlp.139
[16] AmiaoGao,ZenongZhang,SiminWang,LiguoHuang,ShiyiWei,andVincentNg.2025.TeachingAIthe‚ÄòWhy‚Äôand
‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes. https://github.com/amiaog/Teaching-AI-the-Why-and-How-of-Software-
Vulnerability-Fixes
[17] GitContributors.2024.gitdiffManualPage.https://git-scm.com/docs/git-diff. Accessed:2024-09-12.
[18] GeorgiosGousios,MartinPinzger,andArievanDeursen.2014. Anexploratorystudyofthepull-basedsoftware
developmentmodel.InProceedingsofthe36thInternationalConferenceonSoftwareEngineering(Hyderabad,India)
(ICSE2014).AssociationforComputingMachinery,NewYork,NY,USA,345‚Äì355. doi:10.1145/2568225.2568260
[19] TheTcpdumpGroup.2024.Tcpdump4.x.ybytheTcpdumpGroup.https://github.com/the-tcpdump-group/tcpdump.
Accessed:2024-09-13.
[20] D.Guo,S.Lu,N.Duan,Y.Wang,M.Zhou,andJ.Yin.2022.UniXcoder:UnifiedCross-ModalPre-trainingforCode
Representation.doi:10.48550/arXiv.2203.03850arXiv:2203.03850[cs.CL]
[21] DayaGuo,ShuoRen,ShuaiLu,ZhangyinFeng,DuyuTang,ShujieLiu,LongZhou,NanDuan,AlexeySvyatkovskiy,
ShengyuFu,MicheleTufano,ShaoKunDeng,ColinClement,DawnDrain,NeelSundaresan,JianYin,DaxinJiang,and
MingZhou.2021.GraphCodeBERT:Pre-trainingCodeRepresentationswithDataFlow.doi:10.48550/arXiv.2009.08366
arXiv:2009.08366[cs.SE]
[22] EmitzaGuzman,DavidAz√≥car,andYangLi.2014.SentimentanalysisofcommitcommentsinGitHub:anempirical
study.InProceedingsofthe11thWorkingConferenceonMiningSoftwareRepositories(Hyderabad,India)(MSR2014).
AssociationforComputingMachinery,NewYork,NY,USA,352‚Äì355. doi:10.1145/2597073.2597118
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:22 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
[23] MohammadAbdulHadiandFatemehHendijaniFard.2021.Evaluatingpre-trainedmodelsforuserfeedbackanalysis
insoftwareengineering:astudyonclassificationofapp-reviews. EmpiricalSoftwareEngineering28(2021),1‚Äì75.
doi:10.1007/s10664-023-10314-x
[24] KimHerzig,SaschaJust,andAndreasZeller.2013. It‚Äôsnotabug,it‚Äôsafeature:Howmisclassificationimpactsbug
prediction.In201335thInternationalConferenceonSoftwareEngineering(ICSE).392‚Äì401.doi:10.1109/ICSE.2013.6606585
[25] Hugging Face. 2024. ELECTRA Model, Tokenizer, and Config. https://huggingface.co/google/electra-small-
discriminator. Accessed:2024-07-23.
[26] HuggingFace.2024.SpanBERTModelandTokenizer.https://huggingface.co/SpanBERT/spanbert-base-cased. Ac-
cessed:2024-07-23.
[27] DennisJeffrey,MinFeng,NeelamGupta,andRajivGupta.2009.BugFix:Alearning-basedtooltoassistdevelopersin
fixingbugs.In2009IEEE17thInternationalConferenceonProgramComprehension.70‚Äì79.doi:10.1109/ICPC.2009.5090029
[28] TimKientzleandcontributors.2024.Libarchive-Multi-formatArchiveandCompressionLibrary.https://github.com/
libarchive/libarchive. Accessed:2024-09-13.
[29] SunghunKim,ThomasZimmermann,KaiPan,andE.JamesJr.Whitehead.2006. AutomaticIdentificationofBug-
IntroducingChanges.InProceedingsofthe21stIEEE/ACMInternationalConferenceonAutomatedSoftwareEngineering
(ASE‚Äô06).IEEEComputerSociety,USA,81‚Äì90. doi:10.1109/ASE.2006.23
[30] J.RichardLandisandGaryG.Koch.1977.TheMeasurementofObserverAgreementforCategoricalData.Biometrics
33,1(1977),159‚Äì174. doi:10.2307/2529310
[31] JianLi,PinjiaHe,JiemingZhu,andMichaelR.Lyu.2017. SoftwareDefectPredictionviaConvolutionalNeural
Network. 2017IEEEInternationalConferenceonSoftwareQuality,ReliabilityandSecurity(QRS)(2017),318‚Äì328.
https://api.semanticscholar.org/CorpusID:4845285
[32] JinfengLin,YalinLiu,QingkaiZeng,MengJiang,andJaneCleland-Huang.2021.TraceabilityTransformed:Generating
MoreAccurateLinkswithPre-TrainedBERTModels. 2021IEEE/ACM43rdInternationalConferenceonSoftware
Engineering(ICSE)(2021),324‚Äì335.doi:10.1109/ICSE43902.2021.00040
[33] HaoranLiu,YueYu,ShanshanLi,YongGuo,DezeWang,andXiaoguangMao.2020.BugSum:DeepContextUnder-
standingforBugReportSummarization. 2020IEEE/ACM28thInternationalConferenceonProgramComprehension
(ICPC)(2020),94‚Äì105.doi:10.1145/3387904.3389272
[34] KuiLiu,AnilKoyuncu,DongsunKim,andTegawend√©F.Bissyand√©.2019.TBar:revisitingtemplate-basedautomated
programrepair.InProceedingsofthe28thACMSIGSOFTInternationalSymposiumonSoftwareTestingandAnalysis
(Beijing,China)(ISSTA2019).AssociationforComputingMachinery,NewYork,NY,USA,31‚Äì42. doi:10.1145/3293882.
3330577
[35] YinhanLiu,MyleOtt,NamanGoyal,JingfeiDu,MandarJoshi,DanqiChen,OmerLevy,MikeLewis,LukeZettlemoyer,
andVeselinStoyanov.2019. RoBERTa:ARobustlyOptimizedBERTPretrainingApproach. ArXivabs/1907.11692
(2019).doi:10.48550/arXiv.1907.11692
[36] FanLongandMartinRinard.2016. Automaticpatchgenerationbylearningcorrectcode. SIGPLANNot.51,1(jan
2016),298‚Äì312. doi:10.1145/2914770.2837617
[37] ShuaiLu,DayaGuo,ShuoRen,JunjieHuang,AlexeySvyatkovskiy,AmbrosioBlanco,ColinClement,DawnDrain,
DaxinJiang,DuyuTang,GeLi,LidongZhou,LinjunShou,LongZhou,MicheleTufano,MingGong,MingZhou,
NanDuan,NeelSundaresan,ShaoKunDeng,ShengyuFu,andShujieLiu.2021.CodeXGLUE:AMachineLearning
BenchmarkDatasetforCodeUnderstandingandGeneration.doi:10.48550/arXiv.2102.04664arXiv:2102.04664[cs.SE]
[38] DianaMaynard,AdamFunk,andWimPeters.2009.Usinglexico-syntacticontologydesignpatternsforontologycre-
ationandpopulation.InProceedingsofthe2009InternationalConferenceonOntologyPatterns-Volume516(Washington
DC)(WOP‚Äô09).CEUR-WS.org,Aachen,DEU,39‚Äì52.
[39] Nuthan Munaiah, Benjamin S. Meyers, Cecilia Ovesdotter Alm, Andrew Meneely, Pradeep K. Murukannaiah,
EmilyTuckerPrud‚Äôhommeaux,JosephineWolff,andYangYu.2017. NaturalLanguageInsightsfromCodeRe-
viewsthatMissedaVulnerability-ALargeScaleStudyofChromium.InEngineeringSecureSoftwareandSystems.
https://doi-org.proxy.libraries.smu.edu/10.1007/978-3-319-62105-0_5
[40] StasNegara,MihaiCodoban,DannyDig,andRalphE.Johnson.2014. Miningfine-grainedcodechangestodetect
unknownchangepatterns.InProceedingsofthe36thInternationalConferenceonSoftwareEngineering(Hyderabad,
India)(ICSE2014).AssociationforComputingMachinery,NewYork,NY,USA,803‚Äì813. doi:10.1145/2568225.2568317
[41] StephanNeuhaus,ThomasZimmermann,ChristianHoller,andAndreasZeller.2007.Predictingvulnerablesoftware
components.InProceedingsofthe14thACMConferenceonComputerandCommunicationsSecurity(Alexandria,Virginia,
USA)(CCS‚Äô07).AssociationforComputingMachinery,NewYork,NY,USA,529‚Äì540. doi:10.1145/1315245.1315311
[42] KunihiroNoda,YusukeNemoto,KeisukeHotta,HideoTanida,andShinjiKikuchi.2020. ExperienceReport:How
EffectiveisAutomatedProgramRepairforIndustrialSoftware?.In2020IEEE27thInternationalConferenceonSoftware
Analysis,EvolutionandReengineering(SANER).612‚Äì616.doi:10.1109/SANER48275.2020.9054829
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
TeachingAIthe‚ÄòWhy‚Äôand‚ÄòHow‚ÄôofSoftwareVulnerabilityFixes FSE090:23
[43] KaiPan,SunghunKim,andE.JamesWhitehead.2009.Towardanunderstandingofbugfixpatterns.EmpiricalSoftw.
Engg.14,3(jun2009),286‚Äì315. doi:10.1007/s10664-008-9077-5
[44] SheenaPanthaplackel,MilosGligoriƒá,JunyiJessyLi,andRaymondJ.Mooney.2022.UsingDeveloperDiscussionsto
GuideFixingBugsinSoftware.InConferenceonEmpiricalMethodsinNaturalLanguageProcessing.doi:10.48550/arXiv.
2211.06335
[45] F.Pedregosa,G.Varoquaux,A.Gramfort,V.Michel,B.Thirion,O.Grisel,M.Blondel,P.Prettenhofer,R.Weiss,V.
Dubourg,J.Vanderplas,A.Passos,D.Cournapeau,M.Brucher,M.Perrot,andE.Duchesnay.2011.Scikit-learn:Machine
LearninginPython.JournalofMachineLearningResearch12(2011),2825‚Äì2830.doi:10.48550/arXiv.1201.0490
[46] HenningPerl,SergejDechand,MatthewSmith,DanielArp,FabianYamaguchi,KonradRieck,SaschaFahl,andYasemin
Acar.2015.VCCFinder:FindingPotentialVulnerabilitiesinOpen-SourceProjectstoAssistCodeAudits.InProceedings
ofthe22ndACMSIGSACConferenceonComputerandCommunicationsSecurity(Denver,Colorado,USA)(CCS‚Äô15).
AssociationforComputingMachinery,NewYork,NY,USA,426‚Äì437. doi:10.1145/2810103.2813604
[47] GNUProject.2024. GNUBinutils. https://github.com/google/oss-fuzz/tree/master/projects/binutils. Accessed:
2024-09-13.
[48] GNOMEProject.2024.TheXMLCParserandToolkitofGNOME.https://github.com/google/fuzzbench/tree/master/
benchmarks/libxml2_libxml2_xml_reader_for_file_fuzzer. Accessed:2024-09-13.
[49] ZichaoQi,FanLong,SaraAchour,andMartinRinard.2015. Ananalysisofpatchplausibilityandcorrectnessfor
generate-and-validatepatchgenerationsystems.InProceedingsofthe2015InternationalSymposiumonSoftwareTesting
andAnalysis(Baltimore,MD,USA)(ISSTA2015).AssociationforComputingMachinery,NewYork,NY,USA,24‚Äì36.
doi:10.1145/2771783.2771791
[50] SarahRastkar,GailC.Murphy,andGabrielMurray.2010.Summarizingsoftwareartifacts:acasestudyofbugreports.
InProceedingsofthe32ndACM/IEEEInternationalConferenceonSoftwareEngineering-Volume1(CapeTown,South
Africa)(ICSE‚Äô10).AssociationforComputingMachinery,NewYork,NY,USA,505‚Äì514. doi:10.1145/1806799.1806872
[51] PatrickRempelandParickM√§der.2017.PreventingDefects:TheImpactofRequirementsTraceabilityCompleteness
onSoftwareQuality.IEEETrans.Softw.Eng.43,8(aug2017),777‚Äì797. doi:10.1109/TSE.2016.2622264
[52] CarlSabottke,OctavianSuciu,andTudorDumitras.2015. VulnerabilityDisclosureintheAgeofSocialMedia:
ExploitingTwitterforPredictingReal-WorldExploits.In24thUSENIXSecuritySymposium(USENIXSecurity15).
USENIXAssociation,Washington,D.C.,1041‚Äì1056. https://www.usenix.org/conference/usenixsecurity15/technical-
sessions/presentation/sabottke
[53] EnshengShi,YanlinWang,WenchaoGu,LunDu,HongyuZhang,ShiHan,DongmeiZhang,andHongbinSun.2023.
CoCoSoDa:EffectiveContrastiveLearningforCodeSearch.doi:10.48550/arXiv.2204.03293arXiv:2204.03293[cs.SE]
[54] YongheeShin,AndrewMeneely,LaurieWilliams,andJasonA.Osborne.2011.EvaluatingComplexity,CodeChurn,
andDeveloperActivityMetricsasIndicatorsofSoftwareVulnerabilities.IEEETransactionsonSoftwareEngineering37,
6(2011),772‚Äì787.doi:10.1109/TSE.2010.81
[55] JurajSomorovsky,MarioHeiderich,MeikoJensen,J√∂rgSchwenk,NilsGruschka,andLuigiLoIacono.2011.Allyour
cloudsarebelongtous:securityanalysisofcloudmanagementinterfaces.InProceedingsofthe3rdACMWorkshopon
CloudComputingSecurityWorkshop(Chicago,Illinois,USA)(CCSW‚Äô11).AssociationforComputingMachinery,New
York,NY,USA,3‚Äì14. doi:10.1145/2046660.2046664
[56] systemdDevelopers.2024.ThesystemdSystemandServiceManager.https://github.com/systemd/systemd. Accessed:
2024-09-13.
[57] FFmpegTeam.2024. Acomplete,cross-platformsolutiontorecord,convertandstreamaudioandvideo. https:
//github.com/FFmpeg/FFmpeg. Accessed:2024-09-13.
[58] MicheleTufano,CodyWatson,GabrieleBavota,MassimilianoDiPenta,MartinWhite,andDenysPoshyvanyk.2019.
AnEmpiricalStudyonLearningBug-FixingPatchesintheWildviaNeuralMachineTranslation.ACMTrans.Softw.
Eng.Methodol.28,4,Article19(sep2019),29pages. doi:10.1145/3340544
[59] Verizon.2023.DataBreachInvestigationsReport2023.
[60] SiminWang,LiguoHuang,AmiaoGao,JidongGe,TengfeiZhang,HaitaoFeng,IshnaSatyarth,MingLi,HeZhang,
andVincentNg.2022. Machine/DeepLearningforSoftwareEngineering:ASystematicLiteratureReview. IEEE
TransactionsonSoftwareEngineeringPP(012022),1‚Äì1.doi:10.1109/TSE.2022.3173346
[61] ShichaoWang,YunZhang,LiagfengBao,XinXia,andMinghuiWu.2022.VCMatch:ARanking-basedApproachfor
AutomaticSecurityPatchesLocalizationforOSSVulnerabilities.In2022IEEEInternationalConferenceonSoftware
Analysis,EvolutionandReengineering(SANER).589‚Äì600.doi:10.1109/SANER53432.2022.00076
[62] T.Wolf,L.Debut,V.Sanh,J.Chaumond,C.Delangue,A.Moi,P.Cistac,T.Rault,R.Louf,M.Funtowicz,andJ.Brew.
2019.HuggingFace‚ÄôsTransformers:State-of-the-artNaturalLanguageProcessing.https://github.com/huggingface/
transformers.doi:10.18653/v1/2020.emnlp-demos.6Accessed:2024-09-12.
[63] DandanXu,DiTang,YiChen,XiaoFengWang,KaiChen,HaixuTang,andLongxingLi.2024. Racingonthe
NegativeForce:EfficientVulnerabilityRoot-CauseAnalysisthroughReinforcementLearningonCounterexamples.
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.
FSE090:24 AmiaoGao,ZenongZhang,SiminWang,LiGuoHuang,ShiyiWei,andVincentNg
In33rdUSENIXSecuritySymposium(USENIXSecurity24).USENIXAssociation,Philadelphia,PA,4229‚Äì4246. https:
//www.usenix.org/conference/usenixsecurity24/presentation/xu-dandan
[64] YilinYang,TianxingHe,YangFeng,ShaoyingLiu,andBaowenXu.2022.MiningPythonfixpatternsviaanalyzing
fine-grainedsourcecodechanges.EmpiricalSoftwareEngineering27(032022).doi:10.1007/s10664-021-10087-1
[65] SaiZhangandMichaelD.Ernst.2013.Automateddiagnosisofsoftwareconfigurationerrors.In201335thInternational
ConferenceonSoftwareEngineering(ICSE).312‚Äì321.doi:10.1109/ICSE.2013.6606577
[66] ZenongZhang,ZachPatterson,MichaelHicks,andShiyiWei.2022. FIXREVERTER:ARealisticBugInjection
MethodologyforBenchmarkingFuzzTesting.In31stUSENIXSecuritySymposium(USENIXSecurity22).USENIX
Association,Boston,MA,3699‚Äì3715. https://www.usenix.org/conference/usenixsecurity22/presentation/zhang-
zenong
[67] FeiZuoandJunghwanRhee.2024.Vulnerabilitydiscoverybasedonsourcecodepatchcommitmining:asystematic
literaturereview.Int.J.Inf.Secur.23,2(jan2024),1513‚Äì1526. doi:10.1007/s10207-023-00795-8
Received2025-02-26;accepted2025-04-01
Proc.ACMSoftw.Eng.,Vol.2,No.FSE,ArticleFSE090.Publicationdate:July2025.